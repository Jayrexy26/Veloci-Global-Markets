<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Veloci Global Markets | Client Portal</title>

  <meta name="description" content="Veloci Global Markets client portal for market tracking, portfolio tools, and account access." />
  <meta name="robots" content="index, follow" />
  <meta name="theme-color" content="#050a18" />

  <style>
    :root{
      --bg:#050a18;
      --panel:#0b1226;
      --panel2:#0f1a34;
      --stroke:rgba(255,255,255,.12);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.70);
      --muted2:rgba(234,240,255,.55);

      --brand:#3b82f6;
      --brand2:#6366f1;
      --ok:#22c55e;
      --err:#f87171;

      --shadow: 0 30px 120px rgba(0,0,0,.62);
      --shadow2: 0 16px 60px rgba(0,0,0,.55);

      /* âœ… Plan badge colors */
      --badgeStarter: rgba(59,130,246,.45);
      --badgePopular: rgba(34,197,94,.45);
      --badgePro: rgba(168,85,247,.45);
      --badgeElite: rgba(251,191,36,.45);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }

    a{color:inherit}
    .container{
      width:100%;
      max-width:1220px;
      margin:0 auto;
      padding:0 18px;
      position:relative;
      z-index:2;
    }

    /* âœ… Sparkle Canvas Background (FIXED + REAL particles in JS Part 2) */
    #bgCanvas{
      position:fixed;
      inset:0;
      z-index:0;
      pointer-events:none;
      width:100vw;
      height:100vh;
      display:block;

      /* âœ… FIX TOP LEFT "shadow block" by softening + shifting the glow */
      background:
        radial-gradient(860px 520px at 24% 20%, rgba(59,130,246,.11), transparent 74%),
        radial-gradient(900px 560px at 86% 14%, rgba(99,102,241,.16), transparent 70%),
        radial-gradient(720px 520px at 50% 90%, rgba(59,130,246,.08), transparent 72%),
        var(--bg);
    }

    /* âœ… Top bar */
    .topbar{
      position:relative;
      z-index:3;
      background: rgba(17,22,42,.56);
      border-bottom: 1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }
    .topbarInner{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:10px 0;
      font-size:12.5px;
      color:rgba(234,240,255,.72);
      flex-wrap:wrap;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      user-select:none;
    }

    /* âœ… Translator selector */
    .langSelect{
      cursor:pointer;
      appearance:none;
      -webkit-appearance:none;
      border-radius:999px;
      padding:7px 12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color: rgba(234,240,255,.86);
      font-weight:1100;
      outline:none;
      transition:.15s ease;
      max-width:360px;
    }
    .langSelect:hover{ background: rgba(255,255,255,.06); transform: translateY(-1px); }
    .langSelect option{ color:#0b0f19; }

    /* âœ… Navbar */
    header{
      position:sticky;
      top:0;
      z-index:1000;
      background: rgba(5,10,24,.72);
      border-bottom:1px solid rgba(255,255,255,.08);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
    }
    .nav{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 0;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
      text-decoration:none;
      user-select:none;
      min-width: 260px;
      overflow:visible;
      position:relative;
      z-index:5;
    }

    /* âœ… REMOVE small logo box (no longer used) */
    .logo{ display:none !important; }

    /* âœ… BIG logo WITHOUT changing bar height */
    .brandLogoImg{
      height:32px;
      width:auto;
      max-width:260px;
      object-fit:contain;
      filter:
        drop-shadow(0 10px 30px rgba(0,0,0,.55))
        drop-shadow(0 0 22px rgba(59,130,246,.22));
      transform: translateY(1px) scale(2.6);
      transform-origin:left center;
      background: transparent !important;
    }

    nav{
      display:flex;
      align-items:center;
      gap:18px;
      flex-wrap:wrap;
      justify-content:center;
    }
    nav a{
      text-decoration:none;
      font-size:14px;
      color:rgba(234,240,255,.86);
      font-weight:1100;
      opacity:.92;
      transition:.15s ease;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid transparent;
    }
    nav a:hover{
      opacity:1;
      background: rgba(255,255,255,.05);
      border-color: rgba(255,255,255,.08);
    }

    .navCTA{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      min-width: 260px;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      border-radius:999px;
      padding:11px 16px;
      font-weight:1100;
      font-size:14px;
      text-decoration:none;
      transition:.15s ease;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      position:relative;
      overflow:hidden;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px)}
    .btnPrimary{
      border:none;
      color:white;
      background: linear-gradient(180deg, var(--brand), #2563eb);
      box-shadow: 0 18px 55px rgba(37,99,235,.35);
    }
    .btnOutline{
      border:1px solid rgba(96,165,250,.40);
      color:#a6c8ff;
      background: rgba(2,6,23,.12);
    }

    /* âœ… MENU dropdown */
    .menuWrap{ position:relative; }
    .menuBtn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      font-weight:1100;
      color:rgba(234,240,255,.85);
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      padding:10px 12px;
      border-radius:999px;
      transition:.15s ease;
      width:44px;
      height:44px;
    }
    .menuBtn:hover{ background: rgba(255,255,255,.06); transform: translateY(-1px); }
    .menuBtn svg{ width:18px;height:18px; opacity:.98; }

    .menuDropdown{
      position:absolute;
      top: 48px;
      right:0;
      min-width:220px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.90);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      box-shadow: 0 30px 120px rgba(0,0,0,.65);
      padding:10px;
      display:none;
      z-index:9999;
      overflow:hidden;
    }
    .menuDropdown::before{
      content:"";
      position:absolute;
      inset:-60px;
      background: radial-gradient(circle at 25% 20%, rgba(96,165,250,.20), transparent 62%);
      filter: blur(20px);
      opacity:.9;
      pointer-events:none;
    }
    .menuDropdown a{
      position:relative;
      z-index:1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      text-decoration:none;
      padding:10px 12px;
      border-radius:12px;
      color:rgba(234,240,255,.86);
      font-weight:1100;
      border:1px solid transparent;
      background: rgba(255,255,255,.02);
      transition:.12s ease;
      margin:6px 0;
    }
    .menuDropdown a:hover{
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.10);
    }
    .menuDropdown small{
      color: rgba(234,240,255,.55);
      font-weight:1000;
    }

    /* âœ… TradingView Ticker Tape */
    .tickerWrap{
      position:relative;
      z-index:3;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: rgba(2,6,23,.22);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }
    .tickerInner{ padding: 12px 0; }
    .tickerGlass{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      overflow:hidden;
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
    }

    /* âœ… Sections */
    section{
      padding:56px 0;
      position:relative;
      z-index:2;
      scroll-margin-top: 110px;
    }

    /* âœ… scroll unfold + fade */
    .reveal{
      opacity:0;
      transform: translateY(26px) scale(.985);
      transition: opacity .8s ease, transform .8s ease;
      will-change: opacity, transform;
    }
    .reveal.show{
      opacity:1;
      transform: translateY(0) scale(1);
    }

    /* âœ… section highlight on touch */
    .touchHighlight{
      border-radius: 18px;
      transition: box-shadow .35s ease, transform .25s ease;
    }
    .touchHighlight.active{
      box-shadow:
        0 0 0 1px rgba(96,165,250,.18),
        0 0 0 6px rgba(59,130,246,.10),
        0 28px 120px rgba(0,0,0,.40);
      transform: translateY(-1px);
    }

    /* âœ… individual cards highlight */
    .tapHighlight{
      border-radius: 18px;
      transition: box-shadow .35s ease, transform .25s ease, border-color .25s ease;
      will-change: transform, box-shadow;
    }
    .tapHighlight.tapActive{
      box-shadow:
        0 0 0 1px rgba(96,165,250,.18),
        0 0 0 6px rgba(59,130,246,.10),
        0 28px 120px rgba(0,0,0,.40);
      transform: translateY(-1px);
    }

    /* âœ… Plan highlight colors */
    .tapActive.starterGlow{
      box-shadow:
        0 0 0 1px rgba(59,130,246,.22),
        0 0 0 6px rgba(59,130,246,.14),
        0 30px 130px rgba(0,0,0,.55);
    }
    .tapActive.popularGlow{
      box-shadow:
        0 0 0 1px rgba(34,197,94,.22),
        0 0 0 6px rgba(34,197,94,.14),
        0 30px 130px rgba(0,0,0,.55);
    }
    .tapActive.proGlow{
      box-shadow:
        0 0 0 1px rgba(168,85,247,.22),
        0 0 0 6px rgba(168,85,247,.14),
        0 30px 130px rgba(0,0,0,.55);
    }
    .tapActive.eliteGlow{
      box-shadow:
        0 0 0 1px rgba(251,191,36,.22),
        0 0 0 6px rgba(251,191,36,.14),
        0 30px 130px rgba(0,0,0,.55);
    }

    /* âœ… Plan badge */
    .planBadge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      margin-left:10px;
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:1200;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: rgba(234,240,255,.92);
      transform: translateY(-2px);
      white-space:nowrap;
    }
    .badgeStarter{ background: rgba(59,130,246,.18); border-color: rgba(59,130,246,.26); }
    .badgePopular{ background: rgba(34,197,94,.16); border-color: rgba(34,197,94,.26); }
    .badgePro{ background: rgba(168,85,247,.16); border-color: rgba(168,85,247,.26); }
    .badgeElite{ background: rgba(251,191,36,.14); border-color: rgba(251,191,36,.28); }

    /* âœ… HERO */
    .hero{
      padding:78px 0 18px;
      position:relative;
      z-index:2;
    }
    .heroGrid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:30px;
      align-items:center;
    }

    .kicker{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      color:rgba(234,240,255,.78);
      font-weight:1100;
      font-size:13px;
      width:fit-content;
    }
    .kicker b{
      color:#fff;
      background: rgba(59,130,246,.18);
      border:1px solid rgba(96,165,250,.28);
      padding:4px 8px;
      border-radius:999px;
      font-size:12px;
    }

    .hero h2{
      margin:14px 0 10px;
      font-size:52px;
      line-height:1.03;
      letter-spacing:-1.2px;
      font-weight:1100;
      background: linear-gradient(90deg, #eaf0ff, #9cc7ff, #aab4ff);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
      text-shadow: 0 30px 120px rgba(0,0,0,.55);
    }

    .hero p{
      margin:0;
      font-size:16px;
      color:rgba(234,240,255,.72);
      line-height:1.72;
      max-width:660px;
    }
    .heroBtns{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      margin-top:22px;
    }

    .badges{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:18px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12.5px;
      font-weight:1100;
      color:rgba(234,240,255,.78);
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .badge svg{width:16px;height:16px;opacity:.95}

    /* âœ… 3D chart card */
    .chartCard{
      border-radius:24px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
      transform-style: preserve-3d;
      perspective: 1100px;
    }
    .chartCard::before{
      content:"";
      position:absolute;
      inset:-60px;
      background: radial-gradient(circle at 50% 20%, rgba(96,165,250,.26), transparent 62%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .chartTop{
      position:relative;
      z-index:2;
      padding:16px 16px 10px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .chartTop .title{
      font-size:13px;
      font-weight:1100;
      color:rgba(234,240,255,.84);
      letter-spacing:.2px;
      padding:9px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.28);
      display:inline-flex;
      align-items:center;
      gap:10px;
    }
    .livePulse{
      width:8px;height:8px;border-radius:50%;
      background: var(--ok);
      box-shadow: 0 0 0 5px rgba(34,197,94,.12);
    }
    .chartTop .right{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .miniTag{
      font-size:12px;
      font-weight:1100;
      color:rgba(234,240,255,.72);
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }

    .chartArea{
      position:relative;
      z-index:2;
      padding:0 14px 14px;
    }

    .chartFrame{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.30);
      overflow:hidden;
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      position:relative;
      transform: translateZ(18px);
    }
    canvas#chartCanvas{
      display:block;
      width:100%;
      height:330px;
    }
    .glowLine{
      position:absolute;
      inset:auto -30px 14px -30px;
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(96,165,250,.75), transparent);
      filter: blur(.2px);
      opacity:.9;
      z-index:3;
    }

    .chartFooter{
      display:flex;
      gap:10px;
      padding:12px 14px 0;
      flex-wrap:wrap;
      align-items:center;
      justify-content:space-between;
      color:rgba(234,240,255,.66);
      font-size:12.5px;
      font-weight:900;
    }
    .chipRow{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .chip{
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      color:rgba(234,240,255,.72);
      font-weight:1100;
      font-size:12px;
    }

    /* âœ… section title */
    .sectionTitle{
      text-align:center;
      max-width:920px;
      margin:0 auto 24px;
    }
    .sectionTitle h3{
      margin:0;
      font-size:32px;
      font-weight:1100;
      letter-spacing:-.7px;
      background: linear-gradient(90deg, #eaf0ff, #a8c8ff);
      -webkit-background-clip:text;
      background-clip:text;
      color:transparent;
    }
    .sectionTitle p{
      margin:10px 0 0;
      color:rgba(234,240,255,.70);
      line-height:1.7;
      font-size:15px;
    }

    /* âœ… Stats counters */
    .statsGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:14px;
      margin-top:22px;
    }
    .statBox{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      padding:18px 16px;
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      overflow:hidden;
      position:relative;
      text-align:center;
    }
    .statBox::before{
      content:"";
      position:absolute;
      inset:-70px;
      background: radial-gradient(circle at 30% 20%, rgba(96,165,250,.20), transparent 62%);
      filter: blur(20px);
      opacity:.9;
      pointer-events:none;
    }
    .statBox > *{position:relative; z-index:1;}
    .statNum{
      font-size:30px;
      font-weight:1200;
      letter-spacing:-.6px;
      color:#eaf0ff;
    }
    .statLbl{
      margin-top:8px;
      font-size:12.5px;
      font-weight:1100;
      color:rgba(234,240,255,.62);
      letter-spacing:.35px;
      text-transform:uppercase;
    }

    /* âœ… Steps */
    .stepsGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:16px;
    }
    .stepCard{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.28);
      padding:18px 16px;
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      position:relative;
      overflow:hidden;
    }
    .stepCard::before{
      content:"";
      position:absolute;
      inset:-70px;
      background: radial-gradient(circle at 25% 20%, rgba(59,130,246,.14), transparent 62%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .stepCard > *{position:relative; z-index:1;}
    .stepTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:10px;
    }
    .stepIcon{
      width:46px;height:46px;border-radius:16px;
      display:grid;place-items:center;
      background: rgba(59,130,246,.10);
      border:1px solid rgba(96,165,250,.24);
      box-shadow: 0 12px 38px rgba(0,0,0,.35);
    }
    .stepIcon svg{width:22px;height:22px}
    .stepNum{
      font-weight:1200;
      color:rgba(234,240,255,.55);
      letter-spacing:.4px;
      font-size:12px;
    }
    .stepCard h4{
      margin:0;
      font-size:16px;
      font-weight:1200;
      letter-spacing:-.2px;
    }
    .stepCard p{
      margin:8px 0 0;
      color:rgba(234,240,255,.70);
      font-size:14px;
      line-height:1.65;
    }

    /* âœ… Profit Calculator */
    .calcGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:16px;
      align-items:stretch;
      margin-top:18px;
    }
    .calcBox{
      border-radius:24px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      box-shadow: var(--shadow);
      padding:18px 16px;
      position:relative;
      overflow:hidden;
    }
    .calcBox::before{
      content:"";
      position:absolute;
      inset:-80px;
      background: radial-gradient(circle at 30% 20%, rgba(96,165,250,.22), transparent 62%);
      filter: blur(20px);
      opacity:.9;
      pointer-events:none;
    }
    .calcBox > *{position:relative; z-index:1;}
    .calcTitle{
      font-size:15px;
      font-weight:1200;
      color:rgba(234,240,255,.90);
      margin:0 0 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .calcTitle span{
      font-size:12px;
      font-weight:1100;
      color:rgba(234,240,255,.65);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.20);
    }

    .calcField{margin-top:12px;}
    .calcLabel{
      font-size:13px;
      font-weight:1100;
      color:rgba(234,240,255,.70);
      margin-bottom:8px;
    }
    .calcInput, .calcSelect{
      width:100%;
      padding:14px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.30);
      color: var(--text);
      font-size:15px;
      font-weight:900;
      outline:none;
      transition:.18s ease;
    }
    .calcInput:focus, .calcSelect:focus{
      border-color: rgba(96,165,250,.60);
      box-shadow: 0 0 0 4px rgba(59,130,246,.18);
    }

    .calcResult{
      margin-top:14px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.26);
      padding:14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .resCard{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      padding:12px 12px;
    }
    .resCard small{
      display:block;
      color:rgba(234,240,255,.62);
      font-weight:1100;
      font-size:12px;
      margin-bottom:6px;
    }
    .resCard strong{
      font-size:18px;
      font-weight:1200;
      letter-spacing:-.3px;
    }

    /* âœ… Plans */
    .planGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:16px;
      margin-top:18px;
    }
    .planCard{
      border-radius:24px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      box-shadow: var(--shadow2);
      padding:18px 16px;
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height: 320px;
    }
    .planCard::before{
      content:"";
      position:absolute;
      inset:-90px;
      background: radial-gradient(circle at 30% 20%, rgba(96,165,250,.22), transparent 62%);
      filter: blur(22px);
      opacity:.9;
      pointer-events:none;
    }
    .planCard > *{position:relative; z-index:1;}

    /* âœ… NEW: Plan logo moved ABOVE name (inside card, premium) */
    .planLogoTop{
      display:flex;
      justify-content:center;
      margin-top:2px;
      margin-bottom:6px;
    }
    .planLogoTop img{
      width:92px;
      height:auto;
      object-fit:contain;
      filter:
        drop-shadow(0 18px 60px rgba(0,0,0,.55))
        drop-shadow(0 0 24px rgba(96,165,250,.18));
      opacity:.98;
      user-select:none;
      pointer-events:none;
      transform: translateY(-2px);
    }

    .planHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .planName{
      font-weight:1300;
      font-size:18px;
      letter-spacing:-.3px;
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:6px;
    }
    .planTag{
      font-size:12px;
      font-weight:1200;
      color:rgba(234,240,255,.70);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.20);
    }
    .planPrice{
      font-size:28px;
      font-weight:1400;
      letter-spacing:-.6px;
      margin-top:4px;
    }
    .planPrice small{
      font-size:12.5px;
      font-weight:1100;
      color:rgba(234,240,255,.62);
    }
    .planList{
      margin:0;
      padding:0;
      list-style:none;
      display:flex;
      flex-direction:column;
      gap:10px;
      color:rgba(234,240,255,.74);
      font-size:13.5px;
      font-weight:900;
      line-height:1.45;
    }
    .planList li{
      display:flex;
      align-items:flex-start;
      gap:8px;
    }
    .planList svg{width:18px;height:18px; margin-top:1px; opacity:.95;}
    .planBtn{
      margin-top:auto;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .planBtn a{
      width:100%;
      text-align:center;
      justify-content:center;
    }
    .planFeatured{
      border-color: rgba(96,165,250,.34);
      background: linear-gradient(180deg, rgba(59,130,246,.16), rgba(255,255,255,.04));
      transform: translateY(-4px);
    }
    .planGlow{
      position:absolute;
      inset:-60px;
      background: radial-gradient(circle at 50% 20%, rgba(96,165,250,.28), transparent 62%);
      filter: blur(22px);
      opacity:0.95;
      pointer-events:none;
    }

    /* âœ… Referral section */
    .refGrid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:14px;
      margin-top:18px;
    }
    .refCard{
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.30);
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      padding:16px 14px;
      position:relative;
      overflow:hidden;
      text-align:center;
    }
    .refCard::before{
      content:"";
      position:absolute;
      inset:-70px;
      background: radial-gradient(circle at 30% 20%, rgba(59,130,246,.18), transparent 62%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .refCard > *{position:relative; z-index:1;}
    .refPct{
      font-size:32px;
      font-weight:1400;
      letter-spacing:-.7px;
    }
    .refLvl{
      margin-top:8px;
      font-size:12px;
      font-weight:1200;
      color:rgba(234,240,255,.62);
      letter-spacing:.35px;
      text-transform:uppercase;
    }
    .refNote{
      margin-top:10px;
      color:rgba(234,240,255,.72);
      font-size:13px;
      line-height:1.55;
      font-weight:900;
    }

    /* âœ… Partner slider */
    .partnerTrack{
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      overflow:hidden;
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      position:relative;
      margin-top:18px;
    }
    .partnerTrack::before{
      content:"";
      position:absolute;
      inset:-60px;
      background: radial-gradient(circle at 25% 20%, rgba(96,165,250,.18), transparent 62%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .partnerRow{
      display:flex;
      gap:18px;
      padding:16px 10px;
      align-items:center;
      animation: slidePartners 26s linear infinite;
      width:max-content;
      position:relative;
      z-index:1;
    }
    .partnerPill{
      min-width: 160px;
      padding:12px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.26);
      text-align:center;
      font-weight:1200;
      color:rgba(234,240,255,.82);
      letter-spacing:.25px;
      white-space:nowrap;
    }
    @keyframes slidePartners{
      from{ transform: translateX(0); }
      to{ transform: translateX(-50%); }
    }

    /* âœ… Markets row */
    .marketRowWrap{
      max-width:1200px;
      margin:0 auto;
    }
    .marketScroller{
      display:flex;
      gap:14px;
      overflow:hidden;
      padding: 6px 2px 10px;
      position:relative;
    }

    .marketAuto{
      display:flex;
      gap:14px;
      width:max-content;
      animation: autoMarket 90s linear infinite;
    }
    .marketScroller:hover .marketAuto{
      animation-play-state: paused;
    }

    @keyframes autoMarket{
      from{ transform: translateX(0); }
      to{ transform: translateX(-50%); }
    }
    .coinCard{
      min-width: 360px;
      max-width: 360px;
      border-radius:20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.32);
      box-shadow: 0 18px 70px rgba(0,0,0,.38);
      position:relative;
      overflow:hidden;
      padding:16px 14px;
    }
    .coinCard::before{
      content:"";
      position:absolute;
      inset:-60px;
      background: radial-gradient(circle at 25% 20%, rgba(59,130,246,.18), transparent 64%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .coinCardInner{position:relative; z-index:1;}
    .coinTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .coinLeft{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 0;
    }
    .coinLogo{
      width:44px;height:44px;border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      display:grid;
      place-items:center;
      overflow:hidden;
      box-shadow: 0 14px 46px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .coinLogo img{
      width:26px;height:26px;
      object-fit:contain;
      filter: drop-shadow(0 10px 25px rgba(0,0,0,.55));
    }
    .coinMeta{
      min-width: 0;
      display:flex;
      flex-direction:column;
      line-height:1.1;
    }
    .coinName{
      font-size:14px;
      font-weight:1200;
      letter-spacing:-.2px;
      color:rgba(234,240,255,.92);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 200px;
    }
    .coinSym{
      margin-top:4px;
      font-size:12px;
      font-weight:1100;
      color:rgba(234,240,255,.62);
      letter-spacing:.35px;
      text-transform:uppercase;
    }
    .coinRight{text-align:right;}
    .coinPrice{
      font-size:20px;
      font-weight:1300;
      letter-spacing:-.4px;
      color:#eaf0ff;
      white-space:nowrap;
    }
    .coinChange{
      margin-top:6px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:12px;
      font-weight:1200;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      white-space:nowrap;
    }
    .chgUp{ color: rgba(34,197,94,.96); border-color: rgba(34,197,94,.20); background: rgba(34,197,94,.08);}
    .chgDown{ color: rgba(248,113,113,.96); border-color: rgba(248,113,113,.22); background: rgba(248,113,113,.08);}

    .coinBottom{
      margin-top:12px;
      border-top:1px solid rgba(255,255,255,.10);
      padding-top:12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      color:rgba(234,240,255,.65);
      font-size:12.5px;
      font-weight:900;
    }
    .spark{
      width:96px;
      height:30px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.22);
      overflow:hidden;
      position:relative;
    }
    .spark canvas{ width:100%; height:100%; display:block; }

    /* âœ… Testimonials */
    .testGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:16px;
      margin-top:18px;
    }
    .testCard{
      border-radius:22px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      box-shadow: 0 18px 70px rgba(0,0,0,.35);
      padding:18px 16px;
      position:relative;
      overflow:hidden;
    }
    .testCard::before{
      content:"";
      position:absolute;
      inset:-70px;
      background: radial-gradient(circle at 30% 20%, rgba(96,165,250,.20), transparent 62%);
      filter: blur(18px);
      opacity:.9;
      pointer-events:none;
    }
    .testCard > *{position:relative; z-index:1;}
    .stars{
      display:flex;
      gap:4px;
      margin-bottom:10px;
    }
    .stars svg{width:16px;height:16px; opacity:.95;}
    .testText{
      color:rgba(234,240,255,.74);
      font-size:14px;
      line-height:1.65;
      font-weight:900;
    }
    .testUser{
      margin-top:14px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .avatar{
      width:42px;height:42px;border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(2,6,23,.30);
      display:grid;
      place-items:center;
      font-weight:1200;
      color:#eaf0ff;
    }
    .userMeta{
      line-height:1.1;
    }
    .userMeta strong{
      display:block;
      font-weight:1200;
      font-size:13.5px;
    }
    .userMeta span{
      display:block;
      font-weight:900;
      font-size:12px;
      color:rgba(234,240,255,.62);
      margin-top:4px;
    }

    /* âœ… CTA band */
    .ctaBand{padding:0;}
    .ctaBox{
      border-radius:28px;
      border:1px solid rgba(255,255,255,.14);
      background: linear-gradient(180deg, rgba(59,130,246,.18), rgba(2,6,23,.22));
      box-shadow: 0 30px 130px rgba(0,0,0,.65);
      padding:28px 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:18px;
      overflow:hidden;
      position:relative;
    }
    .ctaBox::before{
      content:"";
      position:absolute;
      inset:-70px;
      background: radial-gradient(circle at 20% 20%, rgba(96,165,250,.28), transparent 65%);
      filter: blur(26px);
      opacity:.9;
      pointer-events:none;
    }
    .ctaBox .left{position:relative; z-index:1; max-width:760px;}
    .ctaBox h4{
      margin:0;
      font-size:22px;
      font-weight:1300;
      letter-spacing:-.35px;
      color:#eaf0ff;
    }
    .ctaBox p{
      margin:8px 0 0;
      color:rgba(234,240,255,.70);
      line-height:1.65;
      font-size:14px;
    }
    .ctaBox .right{
      position:relative;
      z-index:1;
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }

    /* âœ… Footer */
    footer{
      padding:26px 0 34px;
      border-top:1px solid rgba(255,255,255,.10);
      background: rgba(2,6,23,.26);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      position:relative;
      z-index:2;
    }
    .footInner{
      text-align:center;
      font-size:12px;
      color:rgba(234,240,255,.66);
      line-height:1.6;
    }

    /* âœ… Footer Veloci Logo (3x bigger) */
    .footerLogoWrap{
      display:flex;
      justify-content:center;
      margin: 6px 0 10px;
    }
    .footerLogo{
      height:38px;
      width:auto;
      max-width:260px;
      object-fit:contain;
      filter:
        drop-shadow(0 18px 60px rgba(0,0,0,.55))
        drop-shadow(0 0 28px rgba(59,130,246,.22));
      transform: scale(3);
      transform-origin:center;
    }

    .footer-links{
      margin-top:12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      justify-content:center;
    }
    .footer-links a{
      color:#9cc7ff;
      font-weight:1100;
      text-decoration:none;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .footer-links a:hover{background: rgba(255,255,255,.06);}

    /* âœ… Footer Disclaimer / Risk Block */
    .risk{
      margin-top:12px;
      max-width:980px;
      margin-left:auto;
      margin-right:auto;
      color: rgba(234,240,255,.55);
      font-size:11.5px;
      line-height:1.75;
      white-space:pre-line;
    }

    /* âœ… Footer bottom row (copyright centered + links below disclaimer) */
    .footerBottom{
      margin-top:16px;
      padding-top:16px;
      border-top:1px solid rgba(255,255,255,.08);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:12px;
    }
    .footerCopy{
      font-size:12px;
      color:rgba(234,240,255,.66);
      font-weight:1000;
      text-align:center;
    }

    /* âœ… Responsive */
    @media(max-width: 1100px){
      .heroGrid{grid-template-columns: 1fr; gap:18px;}
      .hero h2{font-size:44px;}
      .chartCard{max-width:600px;}
      .statsGrid{grid-template-columns: 1fr 1fr;}
      .stepsGrid{grid-template-columns: 1fr 1fr;}
      .calcGrid{grid-template-columns: 1fr;}
      .planGrid{grid-template-columns: 1fr 1fr;}
      .refGrid{grid-template-columns: 1fr 1fr;}
      .testGrid{grid-template-columns: 1fr;}
    }
    @media(max-width: 560px){
      nav{display:none;}

      .topbarInner{
        justify-content:space-between;
      }

      .hero{padding:56px 0 18px;}
      .hero h2{font-size:36px;}

      .brand{
        min-width:auto;
        max-width: 52%;
      }

      .navCTA{
        min-width:auto;
        gap:8px;
      }

      /* Logo smaller scaling so it doesn't hit buttons */
      .brandLogoImg{
        height:28px;
        max-width:200px;
        transform: translateY(1px) scale(2.15);
        transform-origin:left center;
      }

      .coinCard{min-width: 310px; max-width:310px;}
      .planGrid{grid-template-columns: 1fr;}
      .statsGrid{grid-template-columns: 1fr;}
      .stepsGrid{grid-template-columns: 1fr;}

      /* âœ… Testimonials slider on mobile */
      .testGrid{
        display:flex !important;
        overflow-x:auto;
        gap:14px;
        padding: 6px 2px 12px;
        scroll-snap-type:x mandatory;
        -webkit-overflow-scrolling:touch;
        scroll-behavior:smooth;
      }
      .testCard{
        min-width: 86%;
        scroll-snap-align:center;
      }
      .testGrid::-webkit-scrollbar{ height: 8px; }
      .testGrid::-webkit-scrollbar-thumb{
        background: rgba(255,255,255,.10);
        border-radius: 999px;
      }

      /* Footer logo scale down slightly on mobile */
      .footerLogo{
        height:30px;
        transform: scale(2.45);
      }
    }

    /* âœ… Hide Google default translate banner */
    .goog-te-banner-frame.skiptranslate { display: none !important; }
    body { top: 0px !important; }
    #goog-gt-tt, .goog-te-balloon-frame { display:none !important; }
  </style>
</head>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VGM | User Dashboard</title>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#050a18;
      --stroke:rgba(255,255,255,.12);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.65);
      --ok:#22c55e;
      --err:#f87171;
      --blue:#5b6cff;
      --purple:#7c4dff;
      --green:#34d399;
      --cyan:#38bdf8;
      --pink:#ff4da6;
      --shadow: 0 26px 90px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      padding:16px;
      padding-bottom:140px;
      overflow-x:hidden;
      background: var(--bg);
    }

    /* ===== UPPER ECHELON BACKGROUND ===== */
    .bgFlow{
      position:fixed; inset:0; z-index:-4;
      background:
        radial-gradient(900px 520px at 10% 10%, rgba(83,113,255,.30), transparent 55%),
        radial-gradient(900px 520px at 90% 20%, rgba(52,211,153,.20), transparent 55%),
        radial-gradient(900px 520px at 40% 92%, rgba(255,77,166,.16), transparent 60%),
        linear-gradient(180deg, rgba(5,10,24,1), rgba(2,6,23,1));
    }
    .blob{
      position:fixed;
      width:520px;height:520px;border-radius:999px;
      filter: blur(72px);
      opacity:.60;
      z-index:-3;
      mix-blend-mode: screen;
      will-change: transform;
    }
    .blob.b1{ background: rgba(91,108,255,.92); left:-150px; top:-160px; animation: drift1 10s ease-in-out infinite; }
    .blob.b2{ background: rgba(124,77,255,.82); right:-220px; top:5%; animation: drift2 12s ease-in-out infinite; }
    .blob.b3{ background: rgba(52,211,153,.55); left:10%; bottom:-250px; animation: drift3 14s ease-in-out infinite; }
    .blob.b4{ background: rgba(255,77,166,.58); right:10%; bottom:-260px; animation: drift4 11s ease-in-out infinite; }

    @keyframes drift1{0%{transform:translate(0,0) scale(1)}50%{transform:translate(250px,140px) scale(1.10)}100%{transform:translate(0,0) scale(1)}}
    @keyframes drift2{0%{transform:translate(0,0) scale(1)}50%{transform:translate(-280px,170px) scale(1.14)}100%{transform:translate(0,0) scale(1)}}
    @keyframes drift3{0%{transform:translate(0,0) scale(1)}50%{transform:translate(210px,-210px) scale(1.10)}100%{transform:translate(0,0) scale(1)}}
    @keyframes drift4{0%{transform:translate(0,0) scale(1)}50%{transform:translate(-180px,-130px) scale(1.09)}100%{transform:translate(0,0) scale(1)}}

    .shimmer{
      position:fixed; inset:-30px; z-index:-2;
      opacity:.28;
      background:
        radial-gradient(600px 280px at 30% 10%, rgba(255,255,255,.10), transparent 60%),
        radial-gradient(700px 320px at 80% 60%, rgba(255,255,255,.07), transparent 60%),
        linear-gradient(120deg, transparent, rgba(255,255,255,.05), transparent);
      animation: shimmerMove 6s ease-in-out infinite alternate;
      pointer-events:none;
    }
    @keyframes shimmerMove{
      from{transform:translateY(0px) translateX(0px)}
      to{transform:translateY(42px) translateX(22px)}
    }

    .container{max-width:920px;margin:0 auto}

    /* âœ… DESKTOP WIDE VIEW */
    @media (min-width: 1100px){
      .container{max-width:1250px;}
    }
    @media (min-width: 1500px){
      .container{max-width:1380px;}
    }

    /* ===== Loading Gate ===== */
    #authGate{
      position:fixed; inset:0; z-index:99999;
      display:flex; align-items:center; justify-content:center;
      background:
        radial-gradient(900px 420px at 10% 0%, rgba(83,113,255,.22), transparent 55%),
        radial-gradient(900px 420px at 90% 0%, rgba(52,211,153,.18), transparent 55%),
        var(--bg);
    }
    .gateCard{
      width:min(520px,92vw);
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.25);
      border-radius:22px;
      padding:18px;
      box-shadow:0 26px 90px rgba(0,0,0,.55);
      backdrop-filter: blur(14px);
      text-align:center;
    }

    /* âœ… LOGO IMAGE STYLE */
    .logoImg{
      width:100%;
      height:100%;
      object-fit:contain;
      display:block;
    }

    /* âœ… Gate logo now image */
    .gateLogo{
      width:62px;height:62px;border-radius:18px;
      margin:0 auto 10px;
      display:grid;place-items:center;
      border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(109,87,255,1), rgba(124,77,255,1));
      box-shadow:0 18px 50px rgba(109,87,255,.28);
      overflow:hidden;
    }
    .gateTxt{font-weight:1000}
    .gateSub{margin-top:6px;color:rgba(234,240,255,.70);font-weight:900;font-size:13px}
    .spinner{
      width:46px;height:46px;margin:14px auto 0;
      border-radius:999px;
      border:3px solid rgba(255,255,255,.18);
      border-top-color:#9bdcff;
      animation:spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    /* ============================================================
      âœ… STICKY MENU POLISH
    ============================================================ */
    .stickyMenu{
      position:sticky;
      top:12px;
      z-index:3000;
      margin-bottom:10px;
    }
    .stickyMenu::before{
      content:"";
      position:absolute;
      inset:-10px -10px -8px -10px;
      border-radius:26px;
      background:rgba(5,10,24,.58);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 18px 70px rgba(0,0,0,.55);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      z-index:-1;
      pointer-events:none;
      opacity:0;
      transform: translateY(-6px);
      transition: .18s ease;
    }
    .stickyMenu.isStuck::before{
      opacity:1;
      transform: translateY(0);
    }
    .stickyMenu.isStuck .topRow{
      margin-bottom:8px;
    }

    /* ===== TOP BAR ===== */
    .topRow{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin-bottom:14px;
    }

    /* âœ… NEW: TOP LOGO HOLDER (NO BOX) */
    .topLogoLink{
      display:flex;
      align-items:center;
      justify-content:flex-start;
      cursor:pointer;
      user-select:none;
    }
    .brandLogoWide{
      height:86px;              /* ðŸ”¥ MORE MAGNIFIED */
      width:auto;
      max-width:520px;          /* ðŸ”¥ VERY WIDE */
      display:block;
      object-fit:contain;
      filter:
        drop-shadow(0 24px 46px rgba(0,0,0,.60))
        drop-shadow(0 0 32px rgba(91,108,255,.24));
      transform: translateY(2px);
    }

    /* mobile safe but still big */
    @media(max-width:520px){
      .brandLogoWide{
        height:66px;
        max-width:360px;
      }
    }

    .headerActions{display:flex;gap:10px;align-items:center}

    /* âœ… Avatar */
    .avatarBtn{
      width:46px;height:46px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:linear-gradient(180deg, rgba(124,77,255,1), rgba(109,87,255,1));
      cursor:pointer;
      box-shadow:0 16px 40px rgba(124,77,255,.32);
      display:grid;place-items:center;
      position:relative;overflow:hidden;
    }
    .avatarBtn:hover{filter:brightness(1.05)}
    .avatarFallback{font-size:18px;line-height:1;z-index:2;}
    .avatarImgBtn{position:absolute; inset:0;width:100%; height:100%;object-fit:cover;display:none;z-index:3;}

    .iconBtn{
      width:46px;height:46px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.18);
      color:white;font-weight:1000;
      cursor:pointer;
      box-shadow:0 16px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }
    .iconBtn:hover{background:rgba(255,255,255,.08)}

    /* ============================================================
      âœ… HIDE TOP LEFT + PROFILE + MENU BUTTON + DOCK WHEN MENU OPENS
    ============================================================ */
    body.menuOpen #stickyMenu{
      visibility:hidden;
      pointer-events:none;
    }
    body.menuOpen .dock{
      display:none;
    }

    /* ===== HELLO CARD ===== */
    .helloCard{
      border-radius:20px;
      padding:16px 16px;
      overflow:hidden;
      background:
        radial-gradient(800px 220px at 20% 20%, rgba(255,255,255,.18), transparent 60%),
        linear-gradient(90deg, rgba(109,87,255,1), rgba(255,77,166,0.98));
      color:white;
      box-shadow:0 22px 70px rgba(109,87,255,.22);
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .helloLeft{display:flex;align-items:center;gap:12px;}

    /* âœ… verified icon (NOT logo) */
    .verifiedIcon{
      width:48px;height:48px;border-radius:18px;
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.22);
      display:grid;place-items:center;
      font-weight:1000;
      font-size:22px;
      box-shadow:0 18px 50px rgba(0,0,0,.20);
    }

    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:6px}
    .miniChip{
      font-size:12px;font-weight:1000;
      padding:6px 10px;border-radius:999px;
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.22);
      display:flex;gap:6px;align-items:center;
    }
    .helloTitle{font-weight:1000;font-size:18px}
    .helloSub{font-size:12px;font-weight:900;opacity:.92}

    .helloRight{
      display:flex;flex-direction:column;align-items:flex-end;gap:8px;
    }
    .helloRightTop{display:flex;align-items:center;gap:10px}
    .idChip{
      padding:8px 12px;border-radius:999px;
      background:rgba(255,255,255,.18);
      border:1px solid rgba(255,255,255,.22);
      font-weight:1000;font-size:12px;
    }
    .logoutBtn{
      width:46px;height:46px;border-radius:999px;border:none;
      cursor:pointer;
      background:rgba(239,68,68,0.95);
      color:#fff;font-weight:1000;
      box-shadow:0 16px 40px rgba(239,68,68,.22);
    }
    .datetimeChip{
      padding:6px 10px;border-radius:999px;
      background:rgba(255,255,255,.16);
      border:1px solid rgba(255,255,255,.20);
      font-weight:1000;font-size:12px;
      color:#fff;
      white-space:nowrap;
    }

    /* ===== BOX ===== */
    .box{
      border:1px solid rgba(255,255,255,.12);
      border-radius:24px;
      padding:16px;
      background:
        radial-gradient(700px 220px at 12% 10%, rgba(56,189,248,.14), transparent 62%),
        radial-gradient(700px 220px at 88% 18%, rgba(255,77,166,.10), transparent 62%),
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow:0 26px 90px rgba(0,0,0,.55);
      backdrop-filter: blur(12px);
      margin-top:14px;
    }
    .box h2{margin:0;font-size:20px;font-weight:1000}
    .small{color:var(--muted);font-size:13px;margin-top:8px}
    .ok{color:var(--ok);font-weight:1000}
    .err{color:var(--err);font-weight:1000}
    .card{
      border:1px solid rgba(255,255,255,.12);
      border-radius:18px;
      padding:12px;
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }

    /* ===== balanceCard ===== */
    .balanceCard{
      margin-top:14px;
      border-radius:24px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 400px at 15% 20%, rgba(0,0,0,0.55), transparent 55%),
        radial-gradient(900px 400px at 70% 20%, rgba(52,211,153,.24), transparent 55%),
        linear-gradient(135deg, rgba(3,7,18,0.92), rgba(15,23,42,0.84));
      color:white;
      box-shadow: 0 26px 60px rgba(0,0,0,0.25);
      padding:16px;
    }
    .bTitle{font-size:13px;font-weight:1000;opacity:.85}
    .bValue{font-size:34px;font-weight:1000;margin-top:8px}
    .bHint{margin-top:6px;font-size:13px;font-weight:900;opacity:.88;display:flex;gap:10px;align-items:center}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--green)}
    .actionGrid{
      margin-top:16px;
      display:grid;
      grid-template-columns:repeat(4,1fr);
      gap:12px;
    }
    .action{
      border-radius:18px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      padding:12px;
      display:flex;flex-direction:column;
      align-items:center;justify-content:center;
      gap:8px;
      cursor:pointer;
      transition:.18s ease;
    }
    .action:hover{transform: translateY(-2px);background:rgba(255,255,255,.10)}
    .aIcon{
      width:48px;height:48px;border-radius:999px;
      display:grid;place-items:center;
      font-size:20px;
      font-weight:1000;color:#fff;
    }
    .aSend{background:linear-gradient(180deg,#6d57ff,#7c4dff)}
    .aReceive{background:linear-gradient(180deg,#18c07b,#11b981)}
    .aPlans{background:linear-gradient(180deg,#f59e0b,#f97316)}
    .aSupport{background:linear-gradient(180deg,#38bdf8,#5b6cff)}
    .aText{font-weight:1000;font-size:13px}

    /* ===== converters ===== */
    .convGrid{margin-top:14px;display:grid;gap:12px}
    .convRow{display:flex;gap:10px;flex-wrap:wrap}
    .inp{
      flex:1;min-width:140px;
      height:50px;border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.22);
      color:var(--text);
      padding:10px 12px;
      font-weight:1000;
      outline:none;
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }
    .swapBtn{
      width:54px;height:50px;border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.08);
      color:#fff;
      font-weight:1000;
      cursor:pointer;
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }
    .swapBtn:hover{filter:brightness(1.05)}
    .convBtn{
      width:100%;
      height:54px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:linear-gradient(180deg, rgba(91,108,255,1), rgba(124,77,255,1));
      color:white;
      font-weight:1000;
      cursor:pointer;
      box-shadow:0 18px 55px rgba(91,108,255,.18);
      display:flex;align-items:center;justify-content:center;gap:10px;
    }
    .convBtn:hover{filter:brightness(1.05)}
    .rateLine{
      margin-top:10px;
      font-size:12px;
      color:rgba(234,240,255,.75);
      font-weight:900;
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .rateDot{
      width:10px;height:10px;border-radius:999px;
      background:rgba(52,211,153,1);
      box-shadow:0 0 18px rgba(52,211,153,.55);
    }

    /* ===== searchable dropdown unlimited ===== */
    .ddWrap{flex:1;min-width:220px;position:relative}
    .ddBtn{
      width:100%;
      height:50px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.22);
      color:rgba(234,240,255,.95);
      padding:10px 12px;
      font-weight:1000;
      outline:none;
      box-shadow:0 16px 40px rgba(0,0,0,.35);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .ddLeft{display:flex;align-items:center;gap:10px;min-width:0}
    .ddIcon{
      width:34px;height:34px;border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      display:grid;place-items:center;
      font-size:14px;
      overflow:hidden;
    }
    .ddName{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .ddPanel{
      position:absolute; top:56px; left:0; right:0;
      z-index:100;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,23,.94);
      box-shadow:0 26px 90px rgba(0,0,0,.65);
      backdrop-filter: blur(16px);
      overflow:hidden;
      display:none;
    }
    .ddPanel.show{display:block;}
    .ddSearch{
      width:100%;
      height:46px;
      border:none; outline:none;
      padding:0 12px;
      font-weight:1000;
      color:#fff;
      background:rgba(0,0,0,.20);
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .ddList{max-height:320px;overflow:auto;}
    .ddItem{
      padding:12px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      cursor:pointer;
      border-bottom:1px solid rgba(255,255,255,.06);
      color:rgba(234,240,255,.86);
      font-weight:900;
    }
    .ddItem:hover{background:rgba(255,255,255,.06)}
    .ddItem small{color:rgba(234,240,255,.55);font-weight:900}

    /* ===== mini chart ===== */
    .chartWrap{
      margin-top:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }
    .chartHead{
      display:flex;justify-content:space-between;align-items:center;
      padding:10px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      font-weight:1000;
      color:rgba(234,240,255,.78);
      font-size:13px;
    }
    .chartFrame{width:100%;height:340px;border:0;display:block}

    /* ===== ORDER BOOK ===== */
    .orderBookWrap{
      margin-top:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }
    .obHead{
      display:flex;justify-content:space-between;align-items:center;
      padding:10px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      font-weight:1000;
      color:rgba(234,240,255,.78);
      font-size:13px;
    }
    .obStatus{
      display:flex;gap:8px;align-items:center;font-weight:1000;font-size:12px;color:rgba(234,240,255,.70);
    }
    .pulseDot{
      width:9px;height:9px;border-radius:999px;background:rgba(34,197,94,1);
      box-shadow:0 0 18px rgba(34,197,94,.55);
      animation:pulse 1.3s ease-in-out infinite;
    }
    @keyframes pulse{
      0%{transform:scale(.85);opacity:.7}
      50%{transform:scale(1.1);opacity:1}
      100%{transform:scale(.85);opacity:.7}
    }
    .obGrid{
      display:grid;
      grid-template-columns: 1fr 90px 1fr;
      gap:10px;
      padding:12px;
    }
    @media (max-width:720px){
      .obGrid{ grid-template-columns:1fr; }
    }
    .obCol{
      border:1px solid rgba(255,255,255,.10);
      border-radius:16px;
      overflow:hidden;
      background:rgba(0,0,0,.18);
    }
    .obColHead{
      display:flex;justify-content:space-between;gap:10px;
      padding:10px 10px;
      font-weight:1000;font-size:12px;
      border-bottom:1px solid rgba(255,255,255,.08);
      color:rgba(234,240,255,.75);
    }
    .obRows{
      max-height:320px;
      overflow:auto;
    }
    .obRow{
      position:relative;
      display:grid;
      grid-template-columns: 1.15fr 1fr 1fr;
      gap:10px;
      padding:8px 10px;
      font-weight:1000;
      font-size:12px;
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .obRow:last-child{border-bottom:none}
    .obRow span{z-index:2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .obRow .p{color:#f87171}
    .obRow.ask .p{color:#f87171}
    .obRow.bid .p{color:#22c55e}
    .obRow .bgBar{
      position:absolute; inset:0;
      z-index:1;
      opacity:.14;
    }
    .obRow.ask .bgBar{ background:linear-gradient(90deg, rgba(248,113,113,.0), rgba(248,113,113,.55)); transform-origin:right; }
    .obRow.bid .bgBar{ background:linear-gradient(90deg, rgba(34,197,94,.55), rgba(34,197,94,.0)); transform-origin:left; }
    .obMid{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:10px 0;
    }
    .midPrice{
      font-weight:1000;
      font-size:15px;
    }
    .spreadPill{
      font-size:11px;
      font-weight:1000;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.08);
      color:rgba(234,240,255,.80);
    }
    .obFoot{
      padding:10px 12px;
      border-top:1px solid rgba(255,255,255,.10);
      display:flex;justify-content:space-between;gap:10px;
      color:rgba(234,240,255,.65);
      font-size:12px;font-weight:900;
    }

    /* ===== SIDEBAR ===== */
    .overlay{
      position:fixed; inset:0;
      background:rgba(0,0,0,.65);
      display:none; z-index:999;
      backdrop-filter: blur(4px);
    }
    .overlay.show{display:block;}
    .sidebar{
      position:fixed; top:0; left:-315px;
      width:292px; height:100vh;
      padding:16px;
      z-index:1000;
      transition: .28s ease;
      border-right:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 420px at 15% 10%, rgba(91,108,255,.18), transparent 55%),
        radial-gradient(900px 420px at 90% 20%, rgba(52,211,153,.12), transparent 55%),
        linear-gradient(180deg, rgba(4,8,20,0.98), rgba(2,6,23,0.98));
      box-shadow:0 26px 90px rgba(0,0,0,.60);
      backdrop-filter: blur(16px);
      overflow-y:auto;
      -webkit-overflow-scrolling:touch;
      scrollbar-width: thin;
      scrollbar-color: rgba(255,255,255,.18) rgba(0,0,0,0);
    }
    .sidebar::-webkit-scrollbar{width:8px}
    .sidebar::-webkit-scrollbar-track{background:transparent}
    .sidebar::-webkit-scrollbar-thumb{
      background:rgba(255,255,255,.16);
      border-radius:999px;
      border:2px solid rgba(0,0,0,0);
      background-clip:padding-box;
    }
    .sidebar::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.22)}
    .sidebar.open{ left:0; }

    .sideTop{
      display:flex;align-items:center;justify-content:space-between;
      gap:10px;margin-bottom:8px;
    }

    /* âœ… sidebar logo stands alone big (NO BOX) */
    .sideLogoWrap{
      display:flex;
      flex-direction:column;
      align-items:flex-start;
      gap:8px;
      padding:6px 0;
      cursor:pointer;
      user-select:none;
    }
    .sideLogoWide{
      height:92px;             /* ðŸ”¥ MORE MAGNIFIED */
      width:auto;
      max-width:260px;
      display:block;
      object-fit:contain;
      filter:
        drop-shadow(0 24px 46px rgba(0,0,0,.62))
        drop-shadow(0 0 36px rgba(91,108,255,.22));
    }
    .sideLogoSub{
      font-weight:900;
      font-size:12px;
      color:rgba(234,240,255,.62);
      margin-left:2px;
    }

    .closeBtn{
      background:rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.14);
      color:rgba(234,240,255,.95);
      border-radius:14px;
      width:44px;height:44px;
      cursor:pointer;
      display:grid;place-items:center;
      font-weight:1000;
      flex:0 0 auto;
      margin-top:10px;
    }
    .closeBtn:hover{background:rgba(255,255,255,.08)}

    .userTag{
      padding:12px 12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      box-shadow:0 18px 55px rgba(0,0,0,.35);
      margin:10px 0 14px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    .userTagLeft{min-width:0}
    .userTag .t1{color:rgba(234,240,255,.55);font-weight:1000;font-size:12px}
    .userTag .t2{
      margin-top:6px;font-weight:1000;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      max-width:180px;
    }

    .sideAvatar{
      width:46px;height:46px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(0,0,0,.25);
      display:grid;place-items:center;
      position:relative;overflow:hidden;
      box-shadow:0 16px 40px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .sideAvatar span{font-size:18px}
    .sideAvatar img{
      position:absolute; inset:0;
      width:100%;height:100%;
      object-fit:cover;
      display:none;
    }

    .menuGroupTitle{
      margin:10px 0 8px;
      font-size:12px;font-weight:1000;
      color:rgba(234,240,255,.50);
      letter-spacing:.8px;
      text-transform:uppercase;
    }
    .sideItem{
      display:flex;align-items:center;gap:12px;
      padding:12px 12px;border-radius:18px;
      color:rgba(234,240,255,.82);
      text-decoration:none;
      font-weight:1000;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 40px rgba(0,0,0,.35);
      margin-bottom:10px;
      position:relative;overflow:hidden;
    }
    .sideItem:hover{background:rgba(255,255,255,.08)}
    .sideItem .i{
      width:42px;height:42px;border-radius:16px;
      display:grid;place-items:center;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      font-size:18px;
    }
    .sideItem small{display:block;color:rgba(234,240,255,.55);font-size:12px;font-weight:900;margin-top:2px}
    .activeLink{
      border:1px solid rgba(56,189,248,.55);
      background:linear-gradient(180deg, rgba(56,189,248,0.14), rgba(56,189,248,0.08));
      color:#cfefff;
    }
    .activeLink::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(600px 160px at 30% 20%, rgba(56,189,248,.20), transparent 60%);
      pointer-events:none;
    }
    .sideLogout{
      margin-top:10px;
      background:linear-gradient(90deg, rgba(248,113,113,1), rgba(239,68,68,1));
      color:#020617;border:none;width:100%;
      padding:14px;border-radius:18px;font-weight:1000;cursor:pointer;
      box-shadow:0 18px 55px rgba(239,68,68,.18);
    }
    .sideLogout:hover{filter:brightness(1.03)}

    /* ===== DOCK ===== */
    .dock{
      position:fixed;
      left:0; right:0; bottom:14px;
      z-index:2000;
      pointer-events:none;
    }
    .dockInner{
      pointer-events:auto;
      max-width:980px;
      margin:0 auto;
      padding:0 14px;
    }
    .dockBar{
      height:76px;
      border-radius:28px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      box-shadow:0 20px 70px rgba(0,0,0,.45);
      backdrop-filter: blur(14px);
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:10px 12px;
      gap:10px;
    }
    .dockItem{
      flex:1;
      min-width:70px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:6px;
      border-radius:18px;
      padding:10px 0;
      color:rgba(234,240,255,.55);
      font-size:12px;
      font-weight:1000;
      cursor:pointer;
      user-select:none;
      position:relative;
    }
    .dockItem .ico{font-size:18px;opacity:.95}
    .dockItem:hover{background:rgba(255,255,255,.06)}
    .dockActive{color:#9bdcff;background:rgba(56,189,248,.10)}

    .dockHome{
      width:78px;height:78px;border-radius:26px;
      background:linear-gradient(180deg, rgba(109,87,255,1), rgba(91,108,255,1));
      box-shadow:0 22px 55px rgba(109,87,255,.30);
      display:grid;place-items:center;
      margin-top:-32px;
      border:1px solid rgba(255,255,255,.16);
      cursor:pointer;user-select:none;
      flex:0 0 auto;
      pointer-events:auto;
    }
    .dockHome span{font-size:28px;color:white}
    .dockHome:hover{filter:brightness(1.05)}

    .dockBadge{
      position:absolute;
      top:2px;
      right:18px;
      min-width:18px;
      height:18px;
      padding:0 6px;
      border-radius:999px;
      background:#f87171;
      color:#020617;
      font-weight:1000;
      font-size:11px;
      display:none;
      align-items:center;
      justify-content:center;
      border:1px solid rgba(255,255,255,.18);
    }

    /* TOP 10 CRYPTO */
    .crypto10Grid{
      margin-top:12px;
      display:grid;
      gap:10px;
    }
    .cryptoRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 40px rgba(0,0,0,.35);
    }
    .cryptoLeft{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:0;
    }
    .cryptoLogo{
      width:42px;
      height:42px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      display:grid;
      place-items:center;
      overflow:hidden;
      flex:0 0 auto;
    }
    .cryptoLogo img{width:100%;height:100%;object-fit:cover;display:block;}
    .cryptoName{
      font-weight:1000;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .cryptoSym{
      display:block;
      font-size:12px;
      font-weight:1000;
      color:rgba(234,240,255,.55);
      margin-top:2px;
    }
    .cryptoRight{
      text-align:right;
      flex:0 0 auto;
    }
    .cryptoPrice{
      font-weight:1000;
      font-size:14px;
    }
    .cryptoChg{
      margin-top:4px;
      font-weight:1000;
      font-size:12px;
      color:rgba(234,240,255,.65);
    }
    .cryptoChg.up{color:rgba(34,197,94,1)}
    .cryptoChg.down{color:rgba(248,113,113,1)}

    /* NEWS */
    .newsGrid{margin-top:12px;display:grid;gap:10px}
    .newsItem{
      display:flex;
      flex-direction:column;
      gap:8px;
      padding:12px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 40px rgba(0,0,0,.35);
      text-decoration:none;
      color:rgba(234,240,255,.92);
    }
    .newsItem:hover{background:rgba(255,255,255,.06)}
    .newsTop{display:flex;justify-content:space-between;gap:10px;align-items:flex-start}
    .newsTitle{font-weight:1000;font-size:14px;line-height:1.25}
    .newsMeta{
      font-weight:900;
      font-size:12px;
      color:rgba(234,240,255,.55);
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap
    }
    .newsTag{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.08);
      font-weight:1000;
      font-size:11px;
      color:rgba(234,240,255,.80)
    }
    .newsBottom{font-weight:900;font-size:12px;color:rgba(234,240,255,.65)}
  </style>
</head>

<body>
  <div class="bgFlow"></div>
  <div class="blob b1"></div>
  <div class="blob b2"></div>
  <div class="blob b3"></div>
  <div class="blob b4"></div>
  <div class="shimmer"></div>

  <!-- Loading -->
  <div id="authGate">
    <div class="gateCard">
      <div class="gateLogo">
        <img class="logoImg" src="assets/vgm-logo.png" alt="Veloci Global Markets Logo">
      </div>
      <div class="gateTxt">Veloci Global Markets</div>
      <div class="gateSub">Precision trading. Real-time execution.</div>
      <div class="spinner"></div>
    </div>
  </div>

  <div id="overlay" class="overlay" onclick="closeMenu()"></div>

  <!-- Sidebar -->
  <div id="sidebar" class="sidebar">
    <div class="sideTop">
      <div class="sideLogoWrap" onclick="goDashboard()" title="Home">
        <img class="sideLogoWide" src="assets/vgm-logo.png" alt="Veloci Markets Logo">
        <div class="sideLogoSub">Veloci Global Markets</div>
      </div>
      <button class="closeBtn" onclick="closeMenu()">âœ•</button>
    </div>

    <div class="userTag">
      <div class="userTagLeft">
        <div class="t1">Logged in as</div>
        <div id="sideName" class="t2">---</div>
      </div>
      <div class="sideAvatar" title="Profile photo">
        <span id="sideAvatarFallback">ðŸ‘¤</span>
        <img id="sideAvatarImg" alt="Avatar"/>
      </div>
    </div>

    <div class="menuGroupTitle">Navigation</div>
    <a class="sideItem activeLink" href="user-dashboard.html"><div class="i">ðŸ </div><div>Dashboard<small>Main overview</small></div></a>
    <a class="sideItem" href="portfolio.html"><div class="i">ðŸ“Š</div><div>Portfolio<small>Your assets</small></div></a>
    <a class="sideItem" href="deposits.html"><div class="i">ðŸ’³</div><div>Deposit<small>Fund your account</small></div></a>
    <a class="sideItem" href="withdraw.html"><div class="i">âž¡</div><div>Withdraw Funds<small>Request payout</small></div></a>
    <a class="sideItem" href="support.html"><div class="i">ðŸ§‘â€ðŸ’»</div><div>Support / Contact<small>Tickets & help</small></div></a>
    <a class="sideItem" href="plans.html"><div class="i">ðŸ’¼</div><div>Investment Plans<small>Start investing</small></div></a>
    <a class="sideItem" href="profile.html"><div class="i">ðŸ‘¤</div><div>Profile / Settings<small>Account security</small></div></a>
    <button class="sideLogout" onclick="logout()">Logout</button>
  </div>

  <div class="container">
    <div id="stickyMenu" class="stickyMenu">
      <div class="topRow">

        <!-- âœ… TOP LOGO STANDING ALONE (NO BOX, NO TEXT) -->
        <div class="topLogoLink" onclick="goDashboard()" title="Home">
          <img class="brandLogoWide" src="assets/vgm-logo.png" alt="Veloci Global Markets">
        </div>

        <div class="headerActions">
          <button class="avatarBtn" onclick="goProfile()" title="Profile">
            <span id="avatarFallback" class="avatarFallback">ðŸ‘¤</span>
            <img id="avatarImgBtn" class="avatarImgBtn" alt="Avatar"/>
          </button>
          <button class="iconBtn" onclick="openMenu()" title="Menu">â˜°</button>
        </div>
      </div>
    </div>

    <div class="helloCard">
      <div class="helloLeft">
        <!-- âœ… VERIFIED ICON (NOT LOGO) -->
        <div class="verifiedIcon" title="Verified">ðŸ›¡ï¸</div>

        <div>
          <div class="chips">
            <div class="miniChip">ðŸŸ¢ active</div>
            <div class="miniChip" id="countryChip" style="display:none"></div>
          </div>
          <div class="helloTitle" id="greetingTitle">Greetingsâ€¦</div>
          <div class="helloSub" id="helloName">Loadingâ€¦</div>
        </div>
      </div>

      <div class="helloRight">
        <div class="helloRightTop">
          <div class="idChip" id="userIdChip">ID:</div>
          <button class="logoutBtn" onclick="logout()" title="Logout">âŽ‹</button>
        </div>
        <div class="datetimeChip" id="dateTimeNow">--- | ---</div>
      </div>
    </div>

    <div class="balanceCard">
      <div class="bTitle">Total Portfolio Value</div>
      <div class="bValue" id="balance">--</div>
      <div class="bHint"><div class="dot"></div> <div>Your trading account balance</div></div>

      <div class="actionGrid">
        <div class="action" onclick="goWithdrawAndClear()"><div class="aIcon aSend">âœˆï¸</div><div class="aText">Send</div></div>
        <div class="action" onclick="goDepositAndClear()"><div class="aIcon aReceive">â¬‡ï¸</div><div class="aText">Receive</div></div>
        <div class="action" onclick="goPlans()"><div class="aIcon aPlans">ðŸ“ˆ</div><div class="aText">Plans</div></div>
        <div class="action" onclick="goSupportAndClear()"><div class="aIcon aSupport">ðŸ’¬</div><div class="aText">Support</div></div>
      </div>
    </div>

    <div class="box">
      <h2>Active Investment Plan</h2>
      <div id="planMsg" class="small">Loadingâ€¦</div>
      <div id="planBox"></div>
    </div>

    <div class="box">
      <h2>Top 10 Major Cryptos</h2>
      <div class="small">Live market prices (auto refresh every 20 seconds).</div>
      <div id="top10Msg" class="small">Loadingâ€¦</div>
      <div id="top10List" class="crypto10Grid"></div>
    </div>

    <div class="box">
      <h2>Crypto Converter</h2>
      <div class="small">Search & convert from ALL coins to ALL fiat currencies.</div>
      <div class="convGrid">
        <div class="convRow">
          <div class="ddWrap" id="ddCryptoA"></div>
          <button class="swapBtn" onclick="swapCrypto()">â‡„</button>
          <div class="ddWrap" id="ddCryptoB"></div>
        </div>

        <div class="convRow">
          <input id="cryptoAmount" class="inp" type="number" min="0" step="0.00000001" placeholder="Enter amount"/>
        </div>

        <button class="convBtn" onclick="convertCrypto()">âš¡ Convert</button>

        <div class="card">
          <div class="rateLine"><span class="rateDot"></span> <span id="cryptoRate">Rate: --</span></div>
          <div class="small" style="margin-top:10px;font-size:14px;">Result: <strong id="cryptoResult">--</strong></div>
          <div class="small" style="margin-top:10px;font-size:14px;">Reverse: <strong id="cryptoReverse">--</strong></div>
          <div class="small" style="margin-top:10px;font-size:13px;color:rgba(234,240,255,.55)">
            Tip: Search by coin name or symbol (example: â€œbtcâ€, â€œethâ€, â€œsolâ€, â€œxrpâ€).
          </div>
        </div>
      </div>
    </div>

    <div class="box">
      <h2>Fiat Currency Converter</h2>
      <div class="small">Search & convert from ALL fiat currencies to ALL fiat currencies.</div>
      <div class="convGrid">
        <div class="convRow">
          <div class="ddWrap" id="ddFiatA"></div>
          <button class="swapBtn" onclick="swapFiat()">â‡„</button>
          <div class="ddWrap" id="ddFiatB"></div>
        </div>

        <div class="convRow">
          <input id="fiatAmount" class="inp" type="number" min="0" step="0.01" placeholder="Enter amount"/>
        </div>

        <button class="convBtn" onclick="convertFiat()">ðŸ’± Convert Fiat</button>

        <div class="card">
          <div class="rateLine"><span class="rateDot"></span> <span id="fiatRate">Rate: --</span></div>
          <div class="small" style="margin-top:10px;font-size:14px;">Result: <strong id="fiatResult">--</strong></div>
        </div>
      </div>
    </div>

    <div class="box">
      <h2>Live Crypto Order Book</h2>
      <div class="small">Auto refresh every 3 seconds. Binance â†’ OKX â†’ Bybit fallback.</div>

      <div class="convRow" style="margin-top:12px">
        <div class="ddWrap" id="obPairWrap"></div>
        <select id="obPair" style="display:none">
          <option value="BTCUSDT">BTC/USDT</option>
          <option value="ETHUSDT">ETH/USDT</option>
          <option value="BNBUSDT">BNB/USDT</option>
          <option value="XRPUSDT">XRP/USDT</option>
          <option value="SOLUSDT">SOL/USDT</option>
        </select>
      </div>

      <div class="chartWrap">
        <div class="chartHead">
          <span>Mini Candlestick Chart</span>
          <span id="chartPair">BTC/USDT</span>
        </div>
        <iframe id="tvChart" class="chartFrame"></iframe>
      </div>

      <div class="orderBookWrap">
        <div class="obHead">
          <span>Order Book</span>
          <div class="obStatus">
            <span class="pulseDot"></span>
            <span id="obStatusTxt">Connectingâ€¦</span>
          </div>
        </div>

        <div class="obGrid">
          <div class="obCol">
            <div class="obColHead"><span>Asks</span><span>Price / Amount / Total</span></div>
            <div id="obAsks" class="obRows"></div>
          </div>

          <div class="obMid">
            <div class="midPrice" id="obMidPrice">--</div>
            <div class="spreadPill" id="obSpread">Spread: --</div>
          </div>

          <div class="obCol">
            <div class="obColHead"><span>Bids</span><span>Price / Amount / Total</span></div>
            <div id="obBids" class="obRows"></div>
          </div>
        </div>

        <div class="obFoot">
          <div id="obExchange">Source: --</div>
          <div id="obUpdated">Updated: --</div>
        </div>
      </div>
    </div>

    <div class="box">
      <h2>Live Crypto News</h2>
      <div class="small">Latest crypto headlines (auto refresh every 60 seconds).</div>
      <div id="newsMsg" class="small">Loadingâ€¦</div>
      <div id="newsList" class="newsGrid"></div>
    </div>

  </div>

  <!-- DOCK (HOME ICON stays HOME) -->
  <div class="dock">
    <div class="dockInner">
      <div class="dockBar">
        <div class="dockItem" onclick="goDepositAndClear()">
          <div id="badgeDepositDock" class="dockBadge">0</div>
          <div class="ico">ðŸ’³</div><div>Deposit</div>
        </div>

        <div class="dockItem" onclick="goWithdrawAndClear()">
          <div id="badgeWithdrawDock" class="dockBadge">0</div>
          <div class="ico">âž¡</div><div>Withdraw</div>
        </div>

        <div class="dockHome" onclick="goDashboard()"><span>ðŸ </span></div>

        <div class="dockItem" onclick="goPlans()"><div class="ico">ðŸ’¼</div><div>Plans</div></div>
        <div class="dockItem" onclick="goProfile()"><div class="ico">ðŸ‘¤</div><div>Profile</div></div>
      </div>
    </div>
  </div>

  <script>
    /* ============================================================
      âœ… STICKY MENU POLISH SCRIPT
    ============================================================ */
    (function(){
      const sticky = document.getElementById("stickyMenu");
      if(!sticky) return;
      const onScroll = ()=>{
        if(window.scrollY > 14) sticky.classList.add("isStuck");
        else sticky.classList.remove("isStuck");
      };
      onScroll();
      window.addEventListener("scroll", onScroll, {passive:true});
    })();

    /* ============================================================
      âœ… AUTH GUARD
    ============================================================ */
    const SUPABASE_URL="https://xdcscknfomlzwysczegc.supabase.co";
    const SUPABASE_ANON_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhkY3Nja25mb21send5c2N6ZWdjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3MTYzMDMsImV4cCI6MjA4MzI5MjMwM30.E6o2wFFMOpK1DghLUqnxG6Ig09djy4bmDQexprhAiB4";
    const EDGE_CLEAR_BADGE_URL = `${SUPABASE_URL}/functions/v1/clear_badge`;
    const supabaseClient=supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let currentUserEmail="";
    let currentUserId="";
    let badgeChannel=null;

    let ALL_COINS=[];
    let FIATS=[];
    let FX_RATES=null;

    let cryptoDirection="crypto_to_fiat";
    let selectedCryptoA={ id:"bitcoin", label:"Bitcoin (BTC)", icon:"â‚¿", symbol:"btc" };
    let selectedCryptoB={ id:"USD", label:"USD", icon:"$", symbol:"usd" };
    let selectedFiatA={ id:"USD", label:"USD", icon:"$" };
    let selectedFiatB={ id:"NGN", label:"NGN", icon:"â‚¦" };

    let top10Timer=null;
    let newsTimer=null;

    /* NEWS */
    const NEWS_RSS_URL="https://cryptopanic.com/news/rss/";
    const RSS_TO_JSON="https://api.rss2json.com/v1/api.json?rss_url=";

    function timeAgo(ts){
      try{
        const t=new Date(ts).getTime();
        const now=Date.now();
        const s=Math.max(1, Math.floor((now-t)/1000));
        const m=Math.floor(s/60), h=Math.floor(m/60), d=Math.floor(h/24);
        if(d>0) return d+"d ago";
        if(h>0) return h+"h ago";
        if(m>0) return m+"m ago";
        return s+"s ago";
      }catch(e){return ""}
    }
    function esc(s){
      return String(s||"").replace(/[&<>"']/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[m]));
    }
    async function loadNews(){
      const msg=document.getElementById("newsMsg");
      const list=document.getElementById("newsList");
      if(!msg||!list) return;
      try{
        msg.textContent="Loadingâ€¦";
        const url = RSS_TO_JSON + encodeURIComponent(NEWS_RSS_URL);
        const res = await fetch(url);
        const data = await res.json();
        const items = (data?.items || []).slice(0, 12);
        if(!items.length) throw new Error("no news");
        msg.textContent="";
        list.innerHTML = items.map(it=>{
          const title=esc(it.title||"");
          const link=it.link||"#";
          const pub=it.pubDate||it.published||"";
          const src=esc((it.author||"CryptoPanic").trim()||"CryptoPanic");
          const ago = pub ? timeAgo(pub) : "";
          return `<a class="newsItem" href="${link}" target="_blank" rel="noopener">
            <div class="newsTop">
              <div class="newsTitle">${title}</div>
            </div>
            <div class="newsMeta">
              <span class="newsTag">News</span>
              <span>${src}</span>
              ${ago?`<span>â€¢ ${ago}</span>`:""}
            </div>
            <div class="newsBottom">Tap to open full story</div>
          </a>`;
        }).join("");
      }catch(e){
        msg.innerHTML="<span class='err'>Unable to load news (network blocked).</span>";
        list.innerHTML="";
      }
    }
    function startNewsAutoRefresh(){
      if(newsTimer) clearInterval(newsTimer);
      newsTimer=setInterval(loadNews, 60000);
    }

    /* TOP 10 */
    const TOP10_IDS = [
      "bitcoin","ethereum","tether","binancecoin","solana",
      "ripple","usd-coin","dogecoin","cardano","tron"
    ];

    function fmtMoneySmart(n){
      const num=Number(n||0);
      if(num >= 1000) return "$" + num.toLocaleString(undefined,{maximumFractionDigits:2});
      if(num >= 1) return "$" + num.toLocaleString(undefined,{maximumFractionDigits:4});
      return "$" + num.toLocaleString(undefined,{maximumFractionDigits:8});
    }
    function nfmt(n, dp=2){
      return Number(n).toLocaleString(undefined,{minimumFractionDigits:dp, maximumFractionDigits:dp});
    }

    async function loadTop10MajorCryptos(){
      const msg=document.getElementById("top10Msg");
      const list=document.getElementById("top10List");
      if(!msg || !list) return;

      try{
        msg.textContent="Loadingâ€¦";
        const url = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=${encodeURIComponent(TOP10_IDS.join(","))}&order=market_cap_desc&per_page=10&page=1&sparkline=false`;
        const res=await fetch(url);
        const data=await res.json();
        if(!Array.isArray(data) || data.length===0) throw new Error("No data");

        msg.textContent="";
        list.innerHTML = data.map(c=>{
          const chg=Number(c.price_change_percentage_24h||0);
          const chgClass = chg>=0 ? "up" : "down";
          const sign = chg>=0 ? "+" : "";
          return `
            <div class="cryptoRow">
              <div class="cryptoLeft">
                <div class="cryptoLogo">
                  <img src="${c.image}" alt="${c.symbol}"/>
                </div>
                <div style="min-width:0">
                  <div class="cryptoName">${c.name}</div>
                  <span class="cryptoSym">${String(c.symbol||"").toUpperCase()}</span>
                </div>
              </div>
              <div class="cryptoRight">
                <div class="cryptoPrice">${fmtMoneySmart(c.current_price)}</div>
                <div class="cryptoChg ${chgClass}">${sign}${chg.toFixed(2)}% (24h)</div>
              </div>
            </div>
          `;
        }).join("");
      }catch(e){
        msg.innerHTML = "<span class='err'>Unable to load live crypto prices (network blocked).</span>";
        list.innerHTML = "";
      }
    }

    function startTop10AutoRefresh(){
      if(top10Timer) clearInterval(top10Timer);
      top10Timer=setInterval(loadTop10MajorCryptos, 20000);
    }

    /* ORDER BOOK PAIRS */
    const OB_PAIRS = [
      { value:"BTCUSDT", label:"Bitcoin (BTC/USDT)", search:"bitcoin btc usdt btcusdt" },
      { value:"ETHUSDT", label:"Ethereum (ETH/USDT)", search:"ethereum eth usdt ethusdt" },
      { value:"BNBUSDT", label:"BNB (BNB/USDT)", search:"bnb binance bnbusdt usdt" },
      { value:"SOLUSDT", label:"Solana (SOL/USDT)", search:"solana sol solusdt usdt" },
      { value:"XRPUSDT", label:"XRP (XRP/USDT)", search:"xrp ripple xrpusdt usdt" }
    ];

    function mountOBPairs(){
      const wrap=document.getElementById("obPairWrap");
      const hidden=document.getElementById("obPair");
      if(!wrap || !hidden) return;

      wrap.innerHTML = `
        <button class="ddBtn" type="button" id="obPairBtn">
          <div class="ddLeft">
            <div class="ddIcon">â—ˆ</div>
            <div class="ddName" id="obPairName">BTC/USDT</div>
          </div>
          <div>â–¾</div>
        </button>
        <div class="ddPanel" id="obPairPanel">
          <input class="ddSearch" id="obPairSearch" placeholder="Search coin/pair..." />
          <div class="ddList" id="obPairList"></div>
        </div>
      `;

      const btn=document.getElementById("obPairBtn");
      const panel=document.getElementById("obPairPanel");
      const search=document.getElementById("obPairSearch");
      const list=document.getElementById("obPairList");
      const nameEl=document.getElementById("obPairName");

      function render(q=""){
        const s=(q||"").trim().toLowerCase();
        const items = !s ? OB_PAIRS : OB_PAIRS.filter(x => x.search.includes(s) || x.label.toLowerCase().includes(s) || x.value.toLowerCase().includes(s));
        list.innerHTML = items.map(x=>`
          <div class="ddItem" data-val="${x.value}" data-label="${x.label}">
            <span>${x.label}</span>
            <small>tap</small>
          </div>
        `).join("") || `<div class="ddItem"><span>No results</span></div>`;
      }

      function setPair(val, label){
        hidden.value = val;
        nameEl.textContent = label.includes("(") ? label.split("(")[1].replace(")","") : label;
        document.getElementById("chartPair").textContent = nameEl.textContent;
        hidden.dispatchEvent(new Event("change"));
      }

      const init = OB_PAIRS.find(x=>x.value===hidden.value) || OB_PAIRS[0];
      setTimeout(()=>setPair(init.value, init.label), 0);

      render("");

      btn.addEventListener("click",(e)=>{
        e.stopPropagation();
        panel.classList.toggle("show");
        if(panel.classList.contains("show")){
          search.value="";
          render("");
          setTimeout(()=>search.focus(),40);
        }
      });

      search.addEventListener("input",()=>render(search.value));

      list.addEventListener("click",(e)=>{
        const item=e.target.closest(".ddItem");
        if(!item) return;
        const val=item.getAttribute("data-val");
        const label=item.getAttribute("data-label");
        if(!val) return;
        setPair(val,label);
        panel.classList.remove("show");
      });

      document.addEventListener("click",(e)=>{
        if(!wrap.contains(e.target)) panel.classList.remove("show");
      });
    }

    /* ORDER BOOK WS */
    let obWS=null;
    let obReconnectTimer=null;
    let obLastRender=0;
    let obActiveSource="--";

    function setOBStatus(text, ok=true){
      const el=document.getElementById("obStatusTxt");
      if(!el) return;
      el.textContent=text;
      el.style.color = ok ? "rgba(234,240,255,.75)" : "rgba(248,113,113,1)";
    }
    function setOBMeta(exchangeName){
      const ex=document.getElementById("obExchange");
      const up=document.getElementById("obUpdated");
      if(ex) ex.textContent = "Source: " + (exchangeName || "--");
      if(up) up.textContent = "Updated: " + new Date().toLocaleTimeString();
    }

    function renderOB(asks, bids){
      const aEl=document.getElementById("obAsks");
      const bEl=document.getElementById("obBids");
      if(!aEl || !bEl) return;

      const depthA=asks.slice(0,18);
      const depthB=bids.slice(0,18);

      const maxAsk = Math.max(...depthA.map(x=>x.q), 0.0000001);
      const maxBid = Math.max(...depthB.map(x=>x.q), 0.0000001);

      const asksSorted=[...depthA].sort((x,y)=>y.p-x.p);
      const bidsSorted=[...depthB].sort((x,y)=>y.p-x.p);

      let askTotal=0;
      aEl.innerHTML = asksSorted.map(x=>{
        askTotal += x.q;
        const w = Math.min(100, (x.q/maxAsk)*100);
        return `
          <div class="obRow ask">
            <div class="bgBar" style="transform:scaleX(${w/100});"></div>
            <span class="p">${nfmt(x.p, x.p<1?8:2)}</span>
            <span>${nfmt(x.q, x.q<1?6:4)}</span>
            <span>${nfmt(askTotal, askTotal<1?6:4)}</span>
          </div>
        `;
      }).join("") || `<div class="small" style="padding:10px">No asks</div>`;

      let bidTotal=0;
      bEl.innerHTML = bidsSorted.map(x=>{
        bidTotal += x.q;
        const w = Math.min(100, (x.q/maxBid)*100);
        return `
          <div class="obRow bid">
            <div class="bgBar" style="transform:scaleX(${w/100});"></div>
            <span class="p">${nfmt(x.p, x.p<1?8:2)}</span>
            <span>${nfmt(x.q, x.q<1?6:4)}</span>
            <span>${nfmt(bidTotal, bidTotal<1?6:4)}</span>
          </div>
        `;
      }).join("") || `<div class="small" style="padding:10px">No bids</div>`;

      const bestAsk = asks.length ? Math.min(...asks.map(x=>x.p)) : 0;
      const bestBid = bids.length ? Math.max(...bids.map(x=>x.p)) : 0;
      const mid = (bestAsk && bestBid) ? ((bestAsk + bestBid)/2) : 0;
      const spread = (bestAsk && bestBid) ? (bestAsk - bestBid) : 0;

      const midEl=document.getElementById("obMidPrice");
      const spEl=document.getElementById("obSpread");
      if(midEl) midEl.textContent = mid ? nfmt(mid, mid<1?8:2) : "--";
      if(spEl) spEl.textContent = spread ? `Spread: ${nfmt(spread, spread<1?8:4)}` : "Spread: --";
    }

    function stopOB(){
      try{ if(obReconnectTimer) clearTimeout(obReconnectTimer); }catch(e){}
      obReconnectTimer=null;
      try{
        if(obWS){
          obWS.onopen=null; obWS.onmessage=null; obWS.onerror=null; obWS.onclose=null;
          obWS.close();
        }
      }catch(e){}
      obWS=null;
    }
    function scheduleOBReconnect(){
      try{ if(obReconnectTimer) clearTimeout(obReconnectTimer); }catch(e){}
      obReconnectTimer=setTimeout(()=>startOrderBook(), 1500);
    }

    function connectBinanceWS(pair){
      return new Promise((resolve,reject)=>{
        const url = `wss://stream.binance.com:9443/ws/${pair.toLowerCase()}@depth20@100ms`;
        const ws = new WebSocket(url);
        const timer=setTimeout(()=>{
          try{ ws.close(); }catch(e){}
          reject(new Error("binance timeout"));
        }, 1800);
        ws.onopen=()=>{
          clearTimeout(timer);
          resolve({ws, source:"Binance (WS)"});
        };
        ws.onerror=()=>{
          clearTimeout(timer);
          try{ ws.close(); }catch(e){}
          reject(new Error("binance blocked"));
        };
      });
    }

    async function startOrderBook(){
      const pair = document.getElementById("obPair")?.value || "BTCUSDT";
      stopOB();
      setOBStatus("Connectingâ€¦", true);
      setOBMeta("--");

      let connected=null;
      try{
        connected = await connectBinanceWS(pair);
      }catch(e){}

      if(!connected){
        setOBStatus("Disconnected (Network blocked)", false);
        setOBMeta("--");
        return;
      }

      obWS = connected.ws;
      obActiveSource = connected.source;

      setOBStatus("Live", true);
      setOBMeta(obActiveSource);

      obWS.onclose=()=>{
        setOBStatus("Disconnected", false);
        setOBMeta("--");
        scheduleOBReconnect();
      };
      obWS.onerror=()=>{
        setOBStatus("Disconnected", false);
        setOBMeta("--");
        scheduleOBReconnect();
      };

      obWS.onmessage=(ev)=>{
        try{
          const raw = JSON.parse(ev.data);
          const asks=(raw?.a || []).map(x=>({p:Number(x[0]), q:Number(x[1])})).filter(x=>x.p>0 && x.q>0);
          const bids=(raw?.b || []).map(x=>({p:Number(x[0]), q:Number(x[1])})).filter(x=>x.p>0 && x.q>0);
          if(!asks.length || !bids.length) return;

          const now=Date.now();
          if(now - obLastRender < 150) return;
          obLastRender = now;

          renderOB(asks.sort((x,y)=>x.p-y.p), bids.sort((x,y)=>y.p-x.p));
          setOBMeta(obActiveSource);
        }catch(e){}
      };
    }

    /* ===== nav ===== */
    function goPlans(){ window.location.href="plans.html"; }
    function goProfile(){ window.location.href="profile.html"; }
    function goDepositAndClear(){ clearBadge("deposits"); window.location.href="deposits.html"; }
    function goWithdrawAndClear(){ clearBadge("withdrawals"); window.location.href="withdraw.html"; }
    function goSupportAndClear(){ clearBadge("notifications"); window.location.href="support.html"; }
    function goDashboard(){ window.scrollTo({top:0,behavior:"smooth"}); }

    function openMenu(){
      document.getElementById("sidebar").classList.add("open");
      document.getElementById("overlay").classList.add("show");
      document.body.classList.add("menuOpen");
    }
    function closeMenu(){
      document.getElementById("sidebar").classList.remove("open");
      document.getElementById("overlay").classList.remove("show");
      document.body.classList.remove("menuOpen");
    }

    function hideGate(){
      const g=document.getElementById("authGate");
      if(g) g.style.display="none";
    }

    function setGreeting(){
      const h = new Date().getHours();
      let text="Greetings", emoji="âœ¨";
      if(h>=5 && h<12){ text="Good Morning"; emoji="ðŸŒž"; }
      else if(h>=12 && h<17){ text="Good Afternoon"; emoji="â˜€ï¸"; }
      else { text="Good Evening"; emoji="ðŸŒ™"; }
      document.getElementById("greetingTitle").textContent = `${text} ${emoji}`;
    }

    function startClock(){
      const dtEl=document.getElementById("dateTimeNow");
      const days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
      const months=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      const tick=()=>{
        const now=new Date();
        const dayName=days[now.getDay()];
        const day=String(now.getDate()).padStart(2,"0");
        const mon=months[now.getMonth()];
        const yr=now.getFullYear();
        let hh=now.getHours();
        const ampm=hh>=12?"PM":"AM";
        hh=hh%12; hh=hh?hh:12;
        const hhs=String(hh).padStart(2,"0");
        const mm=String(now.getMinutes()).padStart(2,"0");
        const ss=String(now.getSeconds()).padStart(2,"0");
        dtEl.textContent=`${dayName}, ${day} ${mon} ${yr} | ${hhs}:${mm}:${ss} ${ampm}`;
      };
      tick(); setInterval(tick,1000);
    }

    function setTopAvatar(avatarUrl){
      const fallback=document.getElementById("avatarFallback");
      const img=document.getElementById("avatarImgBtn");
      if(avatarUrl){
        img.src=avatarUrl+"?t="+Date.now();
        img.style.display="block";
        fallback.style.display="none";
      }else{
        img.style.display="none";
        fallback.style.display="block";
      }
    }
    function setSideAvatar(avatarUrl){
      const fb=document.getElementById("sideAvatarFallback");
      const img=document.getElementById("sideAvatarImg");
      if(avatarUrl){
        img.src=avatarUrl+"?t="+Date.now();
        img.style.display="block";
        fb.style.display="none";
      }else{
        img.style.display="none";
        fb.style.display="block";
      }
    }
    function setNameEverywhere(fullName){
      const nice=(fullName && fullName.trim()) ? fullName.trim() : "User";
      document.getElementById("helloName").innerHTML=`<span class="ok">${nice}</span>`;
      document.getElementById("sideName").textContent=nice;
    }

    async function loadDashboardIdentity(){
      try{
        let fullName="", avatarUrl="";
        const { data: row } = await supabaseClient.from("users").select("full_name, avatar_url").eq("email", currentUserEmail).maybeSingle();
        if(row){ fullName=row.full_name||""; avatarUrl=row.avatar_url||""; }

        const md=(window.COINLUXORA_USER?.user_metadata||{});
        if(!fullName) fullName=md.full_name||"User";
        if(!avatarUrl) avatarUrl=md.avatar_url||"";

        setNameEverywhere(fullName);
        setTopAvatar(avatarUrl);
        setSideAvatar(avatarUrl);
      }catch(e){
        setNameEverywhere("User");
        setTopAvatar("");
        setSideAvatar("");
      }
    }

    function mountDropdown(elId, items, getLabel, getSearch, onPick, initial){
      const root=document.getElementById(elId);
      root.innerHTML = `
        <button class="ddBtn" type="button">
          <div class="ddLeft">
            <div class="ddIcon">â—ˆ</div>
            <div class="ddName">Select</div>
          </div>
          <div>â–¾</div>
        </button>
        <div class="ddPanel">
          <input class="ddSearch" placeholder="Search..." />
          <div class="ddList"></div>
        </div>
      `;
      const btn=root.querySelector(".ddBtn");
      const panel=root.querySelector(".ddPanel");
      const list=root.querySelector(".ddList");
      const search=root.querySelector(".ddSearch");
      const nameEl=root.querySelector(".ddName");

      let renderItems = items;

      function render(filter=""){
        const q=filter.trim().toLowerCase();
        if(!q){ renderItems = items; }
        else{ renderItems = items.filter(x => getSearch(x).includes(q)); }
        const MAX = Math.min(renderItems.length, 600);
        const slice = renderItems.slice(0, MAX);

        list.innerHTML = slice.map(x => {
          const lab=getLabel(x);
          return `<div class="ddItem" data-id="${encodeURIComponent(JSON.stringify(x))}">
            <span>${lab}</span>
            <small>tap</small>
          </div>`;
        }).join("") || `<div class="ddItem"><span>No results</span></div>`;

        if(renderItems.length > MAX){
          const remain = renderItems.length - MAX;
          list.innerHTML += `<div class="ddItem" style="opacity:.7"><span>Scroll/search to narrow results (${remain} more)â€¦</span></div>`;
        }
      }

      function setSelected(obj){
        nameEl.textContent = getLabel(obj);
        onPick(obj);
      }

      if(initial) setSelected(initial);
      render("");

      btn.addEventListener("click",(e)=>{
        e.stopPropagation();
        panel.classList.toggle("show");
        if(panel.classList.contains("show")){
          search.value="";
          render("");
          setTimeout(()=>search.focus(),40);
        }
      });

      search.addEventListener("input",()=>render(search.value));

      list.addEventListener("click",(e)=>{
        const item=e.target.closest(".ddItem");
        if(!item) return;
        const raw=item.getAttribute("data-id");
        if(!raw) return;
        try{
          const obj=JSON.parse(decodeURIComponent(raw));
          setSelected(obj);
          panel.classList.remove("show");
        }catch{}
      });

      document.addEventListener("click",(e)=>{
        if(!root.contains(e.target)) panel.classList.remove("show");
      });
    }

    const FAVORITES = [
      { id:"bitcoin", label:"Bitcoin (BTC)", icon:"â‚¿", symbol:"btc" },
      { id:"ethereum", label:"Ethereum (ETH)", icon:"Îž", symbol:"eth" },
      { id:"tether", label:"Tether (USDT)", icon:"â‚®", symbol:"usdt" },
      { id:"binancecoin", label:"BNB (BNB)", icon:"â—Ž", symbol:"bnb" },
      { id:"solana", label:"Solana (SOL)", icon:"âŸ ", symbol:"sol" },
      { id:"ripple", label:"XRP (XRP)", icon:"âœ•", symbol:"xrp" }
    ];

    async function loadCoinGeckoLists(){
      try{
        const fiatRes = await fetch("https://api.coingecko.com/api/v3/simple/supported_vs_currencies");
        const fiats = await fiatRes.json();
        FIATS = (fiats || []).map(x => String(x).toUpperCase());
      }catch{
        FIATS = ["USD","NGN","EUR","GBP","CAD","AUD","JPY","CNY","INR"];
      }

      try{
        const coinRes = await fetch("https://api.coingecko.com/api/v3/coins/list?include_platform=false");
        const coins = await coinRes.json();
        const favMap = new Map(FAVORITES.map(f=>[f.id,f]));
        const list = [];
        for(const c of (coins||[])){
          if(!c?.id || !c?.name) continue;
          if(favMap.has(c.id)) continue;
          const sym = (c.symbol||"").toLowerCase();
          list.push({ id:c.id, label:`${c.name}${sym?` (${sym.toUpperCase()})`:""}`, icon:"â—ˆ", symbol:sym });
        }
        ALL_COINS = [...FAVORITES, ...list];
      }catch{
        ALL_COINS = [...FAVORITES];
      }

      const FIAT_ITEMS = FIATS.map(f => ({ id:f, label:f, icon:"$", symbol:f.toLowerCase() }));

      mountDropdown("ddCryptoA", ALL_COINS, x=>x.label, x=>(`${x.label} ${x.symbol} ${x.id}`).toLowerCase(), x=>{ selectedCryptoA=x; }, selectedCryptoA);
      mountDropdown("ddCryptoB", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{ selectedCryptoB=x; }, selectedCryptoB);
      mountDropdown("ddFiatA", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{ selectedFiatA=x; }, selectedFiatA);
      mountDropdown("ddFiatB", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{ selectedFiatB=x; }, selectedFiatB);

      await loadFxRates();
    }

    async function loadFxRates(){
      try{
        const res = await fetch("https://open.er-api.com/v6/latest/USD");
        const data = await res.json();
        if(data?.result !== "success") throw new Error("fx fail");
        FX_RATES = data.rates || {};
      }catch{
        FX_RATES = null;
      }
    }

    function swapCrypto(){
      cryptoDirection = (cryptoDirection === "crypto_to_fiat") ? "fiat_to_crypto" : "crypto_to_fiat";
      const tmp = selectedCryptoA; selectedCryptoA = selectedCryptoB; selectedCryptoB = tmp;

      const FIAT_ITEMS = FIATS.map(f => ({ id:f, label:f, icon:"$", symbol:f.toLowerCase() }));

      if(cryptoDirection === "crypto_to_fiat"){
        if(!selectedCryptoA?.id || typeof selectedCryptoA.id !== "string" || selectedCryptoA.id.length<=4){ selectedCryptoA = FAVORITES[0]; }
        if(!selectedCryptoB?.id || selectedCryptoB.id.length>4) selectedCryptoB = {id:"USD",label:"USD",icon:"$",symbol:"usd"};

        mountDropdown("ddCryptoA", ALL_COINS, x=>x.label, x=>(`${x.label} ${x.symbol} ${x.id}`).toLowerCase(), x=>{selectedCryptoA=x;}, selectedCryptoA);
        mountDropdown("ddCryptoB", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{selectedCryptoB=x;}, selectedCryptoB);
      }else{
        selectedCryptoA = {id:"USD",label:"USD",icon:"$",symbol:"usd"};
        if(!selectedCryptoB?.id || selectedCryptoB.id.length<=4) selectedCryptoB = FAVORITES[0];

        mountDropdown("ddCryptoA", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{selectedCryptoA=x;}, selectedCryptoA);
        mountDropdown("ddCryptoB", ALL_COINS, x=>x.label, x=>(`${x.label} ${x.symbol} ${x.id}`).toLowerCase(), x=>{selectedCryptoB=x;}, selectedCryptoB);
      }

      document.getElementById("cryptoRate").textContent="Rate: --";
      document.getElementById("cryptoResult").textContent="--";
      document.getElementById("cryptoReverse").textContent="--";
    }

    async function convertCrypto(){
      const amt = Number(document.getElementById("cryptoAmount").value || 0);
      if(!amt || amt<=0){
        document.getElementById("cryptoResult").textContent="--";
        document.getElementById("cryptoReverse").textContent="--";
        return;
      }
      try{
        if(cryptoDirection === "crypto_to_fiat"){
          const coinId = selectedCryptoA?.id || "bitcoin";
          const fiat   = String(selectedCryptoB?.id || "USD").toLowerCase();
          const url = `https://api.coingecko.com/api/v3/simple/price?ids=${encodeURIComponent(coinId)}&vs_currencies=${encodeURIComponent(fiat)}`;
          const res = await fetch(url);
          const data = await res.json();
          const rate = Number(data?.[coinId]?.[fiat] || 0);
          if(!rate) throw new Error("rate missing");

          const result = rate * amt;
          document.getElementById("cryptoRate").textContent = `Rate: 1 ${selectedCryptoA.label} = ${nfmt(rate,6)} ${fiat.toUpperCase()}`;
          document.getElementById("cryptoResult").textContent = `${nfmt(result,2)} ${fiat.toUpperCase()}`;
          document.getElementById("cryptoReverse").textContent = `1 ${fiat.toUpperCase()} â‰ˆ ${(1/rate).toFixed(10)} ${selectedCryptoA.symbol?.toUpperCase()||coinId}`;
        }else{
          const fiat = String(selectedCryptoA?.id || "USD").toLowerCase();
          const coinId = selectedCryptoB?.id || "bitcoin";
          const url = `https://api.coingecko.com/api/v3/simple/price?ids=${encodeURIComponent(coinId)}&vs_currencies=${encodeURIComponent(fiat)}`;
          const res = await fetch(url);
          const data = await res.json();
          const rate = Number(data?.[coinId]?.[fiat] || 0);
          if(!rate) throw new Error("rate missing");

          const cryptoAmount = amt / rate;
          document.getElementById("cryptoRate").textContent = `Rate: 1 ${selectedCryptoB.label} = ${nfmt(rate,6)} ${fiat.toUpperCase()}`;
          document.getElementById("cryptoResult").textContent = `${cryptoAmount.toFixed(10)} ${selectedCryptoB.symbol?.toUpperCase()||coinId}`;
          document.getElementById("cryptoReverse").textContent = `1 ${selectedCryptoB.symbol?.toUpperCase()||coinId} â‰ˆ ${nfmt(rate,6)} ${fiat.toUpperCase()}`;
        }
      }catch(e){
        document.getElementById("cryptoRate").textContent="Rate: unavailable (network)";
        document.getElementById("cryptoResult").textContent="--";
        document.getElementById("cryptoReverse").textContent="--";
      }
    }

    function swapFiat(){
      const tmp = selectedFiatA; selectedFiatA = selectedFiatB; selectedFiatB = tmp;
      const FIAT_ITEMS = FIATS.map(f => ({ id:f, label:f, icon:"$", symbol:f.toLowerCase() }));
      mountDropdown("ddFiatA", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{selectedFiatA=x;}, selectedFiatA);
      mountDropdown("ddFiatB", FIAT_ITEMS, x=>x.label, x=>(`${x.label} ${x.id}`).toLowerCase(), x=>{selectedFiatB=x;}, selectedFiatB);
      document.getElementById("fiatRate").textContent="Rate: --";
      document.getElementById("fiatResult").textContent="--";
    }

    async function convertFiat(){
      const amt = Number(document.getElementById("fiatAmount").value || 0);
      if(!amt || amt<=0){
        document.getElementById("fiatResult").textContent="--";
        return;
      }
      const from = String(selectedFiatA?.id || "USD").toUpperCase();
      const to   = String(selectedFiatB?.id || "NGN").toUpperCase();

      try{
        if(!FX_RATES) await loadFxRates();
        if(!FX_RATES) throw new Error("fx missing");

        const fromRate = Number(FX_RATES[from] || 0);
        const toRate   = Number(FX_RATES[to] || 0);
        if(!fromRate || !toRate) throw new Error("rate missing");

        const usdAmount = amt / fromRate;
        const result = usdAmount * toRate;
        const rate = toRate / fromRate;

        document.getElementById("fiatRate").textContent = `Rate: 1 ${from} = ${nfmt(rate,6)} ${to}`;
        document.getElementById("fiatResult").textContent = `${nfmt(result,2)} ${to}`;
      }catch(e){
        document.getElementById("fiatRate").textContent="Rate: unavailable (network)";
        document.getElementById("fiatResult").textContent="--";
      }
    }

    function loadChart(){
      const pair=document.getElementById("obPair").value;
      const base=pair.replace("USDT","").toUpperCase();
      const tvSymbol = `BINANCE:${base}USDT`;
      document.getElementById("chartPair").textContent = `${base}/USDT`;
      const frame=document.getElementById("tvChart");
      frame.src = `https://s.tradingview.com/widgetembed/?frameElementId=tradingview_chart&symbol=${encodeURIComponent(tvSymbol)}&interval=60&hidesidetoolbar=1&symboledit=1&saveimage=1&toolbarbg=rgba(0,0,0,0)&studies=[]&theme=dark&style=1&timezone=Etc/UTC&withdateranges=1&hideideas=1`;
    }

    document.getElementById("obPair").addEventListener("change",()=>{
      loadChart();
      startOrderBook();
    });

    async function loadBalance(){
      const { data } = await supabaseClient.from("users").select("*").eq("email", currentUserEmail).single();
      const balNum = Number(data?.balance || 0);
      const bal = balNum.toLocaleString(undefined,{ minimumFractionDigits:2, maximumFractionDigits:2 });
      document.getElementById("balance").innerHTML = "$" + bal;
    }

    function money(n){ return "$" + Number(n||0).toFixed(2); }

    async function loadActivePlan(){
      const planMsg=document.getElementById("planMsg");
      const planBox=document.getElementById("planBox");

      const { data, error } = await supabaseClient
        .from("investment_plans")
        .select("*")
        .eq("user_email", currentUserEmail)
        .order("created_at",{ascending:false})
        .limit(1);

      if(error){
        planMsg.innerHTML="<span class='err'>"+error.message+"</span>";
        planBox.innerHTML="";
        return;
      }

      if(!data || data.length===0){
        planMsg.innerHTML="<span class='err'>No investment plan started yet.</span>";
        planBox.innerHTML=`<div class="small">Go to <a style="color:#9bdcff;font-weight:1000" href="plans.html">Investment Plans</a> to start.</div>`;
        return;
      }

      planMsg.innerHTML="";
      const plan=data[0];
      const amount=Number(plan.amount||0);
      const roi=Number(plan.roi_percent||0);
      const expected=amount+(amount*(roi/100));

      planBox.innerHTML=`
        <div class="card">
          <strong>${plan.plan_name} Plan</strong>
          <div class="small" style="margin-top:10px">Amount: <strong>${money(amount)}</strong></div>
          <div class="small">ROI: <strong>${roi}%</strong></div>
          <div class="small">Expected Return: <strong>${money(expected)}</strong></div>
        </div>
      `;
    }

    function setBadge(elId, count){
      const el=document.getElementById(elId);
      if(!el) return;
      const n=Number(count||0);
      if(n<=0) el.style.display="none";
      else { el.style.display="flex"; el.innerText = n>99?"99+":String(n); }
    }
    function setBadgeFromKey(key,val){
      if(key==="deposits") setBadge("badgeDepositDock", val);
      else if(key==="withdrawals") setBadge("badgeWithdrawDock", val);
    }

    async function loadRealtimeBadgesOnce(){
      if(!currentUserId) return;
      setBadge("badgeDepositDock", 0);
      setBadge("badgeWithdrawDock", 0);

      const { data, error } = await supabaseClient
        .from("user_badges")
        .select("badge_key, badge_value")
        .eq("user_id", currentUserId);

      if(error) return;
      (data || []).forEach(row => setBadgeFromKey(row.badge_key, row.badge_value));
    }

    function subscribeToRealtimeBadges(){
      if(!currentUserId) return;
      if(badgeChannel){
        supabaseClient.removeChannel(badgeChannel);
        badgeChannel=null;
      }
      badgeChannel = supabaseClient
        .channel("realtime-user-badges-dashboard")
        .on("postgres_changes", {
          event: "*",
          schema: "public",
          table: "user_badges",
          filter: `user_id=eq.${currentUserId}`
        }, payload => {
          const row = payload.new;
          if(!row) return;
          setBadgeFromKey(row.badge_key, row.badge_value);
        })
        .subscribe();
    }

    async function clearBadge(badge_key){
      try{
        const { data: sessionData } = await supabaseClient.auth.getSession();
        const accessToken = sessionData?.session?.access_token;
        if(!accessToken) return;

        await fetch(EDGE_CLEAR_BADGE_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Authorization": `Bearer ${accessToken}`,
            "apikey": SUPABASE_ANON_KEY
          },
          body: JSON.stringify({ badge_key })
        });
      }catch(e){}
    }

    async function logout(){
      await supabaseClient.auth.signOut();
      window.location.replace("login.html");
    }

    function initWithUser(user){
      currentUserEmail=user.email;
      currentUserId=user.id;

      setGreeting();
      startClock();
      document.getElementById("userIdChip").innerText = "ID: " + currentUserId.slice(0,6).toUpperCase();

      hideGate();
      loadDashboardIdentity();
      loadBalance();
      loadActivePlan();
      loadRealtimeBadgesOnce();
      subscribeToRealtimeBadges();

      loadTop10MajorCryptos();
      startTop10AutoRefresh();

      loadNews();
      startNewsAutoRefresh();

      loadCoinGeckoLists().then(async ()=>{
        mountOBPairs();
        loadChart();
        startOrderBook();
      });
    }

    (async function authGuard(){
      try{
        const { data: sessionData } = await supabaseClient.auth.getSession();
        const session = sessionData?.session;
        if(!session){ window.location.replace("login.html"); return; }

        const { data, error } = await supabaseClient.auth.getUser();
        const user = data?.user;
        if(error || !user){ window.location.replace("login.html"); return; }

        const confirmed = !!(user.email_confirmed_at || user.confirmed_at || user.user_metadata?.email_verified === true);

        if(!confirmed){
          await supabaseClient.auth.signOut();
          window.location.replace("verify.html?status=unverified");
          return;
        }

        window.COINLUXORA_USER=user;
        initWithUser(user);
      }catch(e){
        window.location.replace("login.html");
      }
    })();
  </script>
</body>
</html>
